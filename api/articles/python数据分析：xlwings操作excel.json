{"title":"python数据分析：xlwings操作excel","uid":"b183580f01b4c460a08090715fbc01f0","slug":"python数据分析：xlwings操作excel","date":"2022-01-16T11:16:09.000Z","updated":"2022-04-03T06:07:37.193Z","comments":true,"path":"api/articles/python数据分析：xlwings操作excel.json","keywords":null,"cover":null,"content":"<h5 id=\"xlwings是Python中操作Excel的一个第三方库，支持-xls读写，-xlsx读写，操作非常简单，功能也很强大\"><a href=\"#xlwings是Python中操作Excel的一个第三方库，支持-xls读写，-xlsx读写，操作非常简单，功能也很强大\" class=\"headerlink\" title=\"xlwings是Python中操作Excel的一个第三方库，支持.xls读写，.xlsx读写，操作非常简单，功能也很强大\"></a>xlwings是Python中操作Excel的一个第三方库，支持.xls读写，.xlsx读写，操作非常简单，功能也很强大</h5><h5 id=\"xlwings与VBA的配合非常完美，你可以在python中调用VBA，也可以在VBA中使用python编程，这些通过xlwings都可以巧妙实现。\"><a href=\"#xlwings与VBA的配合非常完美，你可以在python中调用VBA，也可以在VBA中使用python编程，这些通过xlwings都可以巧妙实现。\" class=\"headerlink\" title=\"xlwings与VBA的配合非常完美，你可以在python中调用VBA，也可以在VBA中使用python编程，这些通过xlwings都可以巧妙实现。\"></a>xlwings与VBA的配合非常完美，你可以在python中调用VBA，也可以在VBA中使用python编程，这些通过xlwings都可以巧妙实现。</h5><p>先说装这个xlwings碰到个神坑：</p>\n<p>用pip install pywin32装完之后错误就来了</p>\n<p>DLL load failed while importing win32api: 找不到指定的程序。<br>md搞死我了</p>\n<p>查不到，再查，再查，再查。。。</p>\n<p>解决方法：<a class=\"link\"   href=\"https://links.jianshu.com/go?to=https://www.cnblogs.com/Swalllow/p/11711750.html\" >https://www.cnblogs.com/Swalllow/p/11711750.html<i class=\"fas fa-external-link-alt\"></i></a><br>找到文件pywin32_postinstall.py的路径，</p>\n<p>由于安装路径不同，可能位置不一样，可以在你安装python的文件夹搜索这个文件，</p>\n<p>一般在安装文件下的Scripts文件里，用cmd进入这个Scripts文件夹</p>\n<p>如cd/d D:\\install\\python3.8\\Scripts</p>\n<p>在路径下运行python pywin32_postinstall.py -install</p>\n<p>再检查一次是否成功</p>\n<p>芜湖~，居然好了</p>\n<p>学习xlwings看这里：</p>\n<p><a class=\"link\"   href=\"https://www.kancloud.cn/gnefnuy/xlwings-docs/1127455\" >https://www.kancloud.cn/gnefnuy/xlwings-docs/1127455<i class=\"fas fa-external-link-alt\"></i></a><br><a class=\"link\"   href=\"https://www.cnblogs.com/Renyi-Fan/p/13244027.html\" >https://www.cnblogs.com/Renyi-Fan/p/13244027.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">import pandas as pd\nimport xlwings as xw</code></pre>\n\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"># 建立excel表连接\nwb &#x3D; xw.Book(&quot;out.xlsx&quot;)\n#     实例化工作表对象\nsht &#x3D; wb.sheets[&quot;源数据&quot;]\nsht</code></pre>\n\n\n<pre><code>&lt;Sheet [out.xlsx]源数据&gt;\n</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     返回工作表绝对路径\nwb.fullname</code></pre>\n\n\n<pre><code>&#39;C:\\\\Users\\\\supermanzwg\\\\workspace\\\\3Data_Processing(自动化)\\\\out.xlsx&#39;\n</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     返回工作簿的名字\n\nsht.name</code></pre>\n\n\n<pre><code>&#39;源数据&#39;\n</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     在单元格中写入数据\nsht.range(&#39;A1&#39;).value &#x3D; &quot;xlwing牛逼啊&quot;\nsht</code></pre>\n\n\n<pre><code>&lt;Sheet [out.xlsx]源数据&gt;\n</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     读取单元格内容\nsht.range(&#39;A1&#39;).value</code></pre>\n\n\n<pre><code>&#39;xlwing牛逼啊&#39;\n</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     清除单元格内容和格式\nsht.range(&#39;A1&#39;).clear()</code></pre>\n\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     获取单元格的列标\nsht.range(&#39;A1&#39;).column</code></pre>\n\n\n<pre><code>1\n</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     获取单元格的行标\nsht.range(&#39;A1&#39;).row</code></pre>\n\n<pre><code>1\n</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     获取单元格的行高\nsht.range(&#39;A1&#39;).row_height</code></pre>\n\n<pre><code>13.2\n</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     获取单元格的列宽\nsht.range(&#39;A1&#39;).column_width</code></pre>\n\n<pre><code>8.47\n</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     列宽自适应\nsht.range(&#39;A1:A99&#39;).columns.autofit()\nsht</code></pre>\n\n<pre><code>&lt;Sheet [out.xlsx]源数据&gt;\n</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     行高自适应\nsht.range(&#39;A1:M1&#39;).rows.autofit()</code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     给单元格上背景色，传入RGB值\nsht.range(&#39;A1&#39;).color &#x3D; (34,139,34)</code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     获取单元格颜色，RGB值\nsht.range(&#39;A1&#39;).color</code></pre>\n\n<pre><code>(34, 139, 34)\n</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     清除单元格颜色\nsht.range(&#39;A1&#39;).color &#x3D; None</code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     输入公式，相应单元格会出现计算结果\nsht.range(&#39;A1&#39;).formula&#x3D;&#39;&#x3D;SUM(H6:H7)&#39;</code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     获取单元格公式\nsht.range(&#39;A1&#39;).formula_array</code></pre>\n\n<pre><code>&#39;=SUM(H6:H7)&#39;\n</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     在单元格中写入批量数据，只需要指定其实单元格位置即可\nsht.range(&#39;A2&#39;).value &#x3D; [[&#39;Foo 1&#39;, &#39;Foo 2&#39;, &#39;Foo 3&#39;], [10.0, 20.0, 30.0]]</code></pre>\n\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     读取表中批量数据，使用expand()方法\nsht.range(&#39;A2&#39;).expand().value</code></pre>\n\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     其实你也可以不指定工作表的地址，直接与电脑里的活动表格进行交互\n# 写入\nxw.Range(&quot;E1&quot;).value &#x3D; &quot;xlwings&quot;# 读取\nxw.Range(&quot;E1&quot;).value</code></pre>\n\n<pre><code>&#39;xlwings&#39;\n</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">xw.range(&quot;E2&quot;).value &#x3D; &quot;xlwings&quot;</code></pre>\n\n<pre><code>---------------------------------------------------------------------------\n\nAttributeError                            Traceback (most recent call last)\n\nC:\\Users\\SUPERM~1\\AppData\\Local\\Temp/ipykernel_10040/191138757.py in &lt;module&gt;\n----&gt; 1 xw.range(&quot;E2&quot;).value = &quot;xlwings&quot;\n\nAttributeError: module &#39;xlwings&#39; has no attribute &#39;range&#39;\n</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"># xlwings与numpy、pandas、matplotlib互动\n#     支持写入numpy array数据类型\n\nimport numpy as np\nnp_data &#x3D; np.array((1,2,3))\nsht.range(&#39;F1&#39;).value &#x3D; np_data</code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     支持将pandas DataFrame数据类型写入excel\n\nimport pandas as pd\ndf &#x3D; pd.DataFrame([[1,2], [3,4]], columns&#x3D;[&#39;a&#39;, &#39;b&#39;])\nsht.range(&#39;A5&#39;).value &#x3D; df</code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     将数据读取，输出类型为DataFrame\n\nsht.range(&#39;A5&#39;).options(pd.DataFrame,expand&#x3D;&#39;table&#39;).value</code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">#     将matplotlib图表写入到excel表格里\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\nfig &#x3D; plt.figure()\nplt.plot([1, 2, 3, 4, 5])\nsht.pictures.add(fig, name&#x3D;&#39;MyPlot&#39;, update&#x3D;True)\n\n# xlwings与VBA互相调用\n</code></pre>\n\n<pre><code>&lt;Picture &#39;MyPlot&#39; in &lt;Sheet [out.xlsx]源数据&gt;&gt;\n</code></pre>\n","text":"xlwings是Python中操作Excel的一个第三方库，支持.xls读写，.xlsx读写，操作非常简单，功能也很强大xlwings与VBA的配合非常完美，你可以在python中调用VBA，也可以在VBA中使用python编程，这些通过xlwings都可以巧妙实现。先说装这个x...","link":"","photos":[],"count_time":{"symbolsCount":"3.5k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"数据分析","slug":"数据分析","count":18,"path":"api/tags/数据分析.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#xlwings%E6%98%AFPython%E4%B8%AD%E6%93%8D%E4%BD%9CExcel%E7%9A%84%E4%B8%80%E4%B8%AA%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%EF%BC%8C%E6%94%AF%E6%8C%81-xls%E8%AF%BB%E5%86%99%EF%BC%8C-xlsx%E8%AF%BB%E5%86%99%EF%BC%8C%E6%93%8D%E4%BD%9C%E9%9D%9E%E5%B8%B8%E7%AE%80%E5%8D%95%EF%BC%8C%E5%8A%9F%E8%83%BD%E4%B9%9F%E5%BE%88%E5%BC%BA%E5%A4%A7\"><span class=\"toc-text\">xlwings是Python中操作Excel的一个第三方库，支持.xls读写，.xlsx读写，操作非常简单，功能也很强大</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#xlwings%E4%B8%8EVBA%E7%9A%84%E9%85%8D%E5%90%88%E9%9D%9E%E5%B8%B8%E5%AE%8C%E7%BE%8E%EF%BC%8C%E4%BD%A0%E5%8F%AF%E4%BB%A5%E5%9C%A8python%E4%B8%AD%E8%B0%83%E7%94%A8VBA%EF%BC%8C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%9C%A8VBA%E4%B8%AD%E4%BD%BF%E7%94%A8python%E7%BC%96%E7%A8%8B%EF%BC%8C%E8%BF%99%E4%BA%9B%E9%80%9A%E8%BF%87xlwings%E9%83%BD%E5%8F%AF%E4%BB%A5%E5%B7%A7%E5%A6%99%E5%AE%9E%E7%8E%B0%E3%80%82\"><span class=\"toc-text\">xlwings与VBA的配合非常完美，你可以在python中调用VBA，也可以在VBA中使用python编程，这些通过xlwings都可以巧妙实现。</span></a></li></ol>","author":{"name":"弦好想断","slug":"blog-author","avatar":"/img/avatar.jpg","link":"/","description":"处女座男生，热爱技术、吉他、旅行。","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"sql排名函数","uid":"68c9396da13a152d585d7816d6c82312","slug":"sql排名函数","date":"2021-12-23T03:14:23.000Z","updated":"2022-04-03T06:06:41.689Z","comments":true,"path":"api/articles/sql排名函数.json","keywords":null,"cover":null,"text":" rank()排名是不连续的，出现同名的排序序号会相同(比较常规的排序)，存在并列，且序号会跳跃 适合求第一名，名次这类 select employee_id ,last_name ,department_id ,salary ,rank() over(partition by ...","link":"","photos":[],"count_time":{"symbolsCount":783,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"数据分析","slug":"数据分析","count":18,"path":"api/tags/数据分析.json"}],"author":{"name":"弦好想断","slug":"blog-author","avatar":"/img/avatar.jpg","link":"/","description":"处女座男生，热爱技术、吉他、旅行。","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}