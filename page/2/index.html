<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="弦好想断">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="弦好想断">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="WenGe Zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>弦好想断</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">弦好想断</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/07/21/python-flask%E7%96%AB%E6%83%85%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WenGe Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="弦好想断">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/21/python-flask%E7%96%AB%E6%83%85%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" class="post-title-link" itemprop="url">python-flask疫情数据可视化</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-07-21 14:18:39" itemprop="dateCreated datePublished" datetime="2021-07-21T14:18:39+08:00">2021-07-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-03 14:06:25" itemprop="dateModified" datetime="2022-04-03T14:06:25+08:00">2022-04-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Flask是一个轻量级的web框架，看了<a class="link"   target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV177411j7qJ" >https://www.bilibili.com/video/BV177411j7qJ<i class="fas fa-external-link-alt"></i></a> 大佬的视频，做的一个疫情可视化项目,（电脑屏幕小看着有点拥挤。大屏展示还是挺好看的），热搜词云的数据找不到网站了，就弄了个表格；自己修改了一些部分，感兴趣的可以去康康视频，后续有时间再写点总结。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.3zeoic47abi8.png"
                     
                ></p>
<p>关于flask：<br><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/songboriceboy/category/1867414.html" >https://www.cnblogs.com/songboriceboy/category/1867414.html<i class="fas fa-external-link-alt"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/u014793102/category_9285123.html?spm=1001.2014.3001.5482" >https://blog.csdn.net/u014793102/category_9285123.html?spm=1001.2014.3001.5482<i class="fas fa-external-link-alt"></i></a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/07/04/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%EF%BC%9A%E8%BF%9E%E6%8E%A5mysql%EF%BC%8C%E8%AF%BB%E5%8F%96%E3%80%81%E5%86%99%E5%85%A5%E3%80%81%E6%9B%B4%E6%96%B0%E3%80%81%E5%88%A0%E9%99%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WenGe Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="弦好想断">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/04/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%EF%BC%9A%E8%BF%9E%E6%8E%A5mysql%EF%BC%8C%E8%AF%BB%E5%8F%96%E3%80%81%E5%86%99%E5%85%A5%E3%80%81%E6%9B%B4%E6%96%B0%E3%80%81%E5%88%A0%E9%99%A4/" class="post-title-link" itemprop="url">python连接mysql:读取、写入、更新、删除</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-07-04 13:16:15" itemprop="dateCreated datePublished" datetime="2021-07-04T13:16:15+08:00">2021-07-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-03 14:07:42" itemprop="dateModified" datetime="2022-04-03T14:07:42+08:00">2022-04-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1、连接读取数据"><a href="#1、连接读取数据" class="headerlink" title="1、连接读取数据"></a>1、连接读取数据</h2><h3 id="第一种：用pymysql连接"><a href="#第一种：用pymysql连接" class="headerlink" title="第一种：用pymysql连接"></a>第一种：用pymysql连接</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#安装pymysql</span><br><span class="line">conda install pymysql</span><br><span class="line">#或者</span><br><span class="line">pip install pymysql</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import pymysql</span><br><span class="line">#创建数据库连接，依次是主机名，用户名，密码，要打开的数据库，端口号和编码类型</span><br><span class="line">def get_conn():</span><br><span class="line">    conn = pymysql.connect(</span><br><span class="line">        host=&quot;****&quot;,</span><br><span class="line">        user=&quot;****&quot;,</span><br><span class="line">        password=&quot;****&quot;,</span><br><span class="line">        db=&quot;****&quot;,</span><br><span class="line">        charset=&quot;utf8&quot;,</span><br><span class="line">        port=3306,</span><br><span class="line">    )</span><br><span class="line">    # 创建游标：</span><br><span class="line">    cursor = conn.cursor()</span><br><span class="line">    return conn, cursor</span><br><span class="line">def close_conn(conn, cursor):</span><br><span class="line">    if cursor:</span><br><span class="line">        cursor.close()</span><br><span class="line">    if conn:</span><br><span class="line">        conn.close()</span><br><span class="line">def query(sql, *args):</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    :param sql:</span><br><span class="line">    :param args:</span><br><span class="line">    :return:返回结果，提取数据，返回的data是一个二维元组，((),())形式；</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    conn, cursor= get_conn()</span><br><span class="line">    cursor.execute(sql)</span><br><span class="line">    res = cursor.fetchall() # 获取结果</span><br><span class="line">    close_conn(conn, cursor)</span><br><span class="line">    return res</span><br><span class="line">#返回的是所有行在对应列的值</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># connect.commit()</span><br><span class="line">#如果对数据进行了增删改查的话，执行该语句，相当于把对数据库的操作提交上去，否则修改不会生效</span><br><span class="line">close_conn(conn, cursor)#当然要有关闭游标和数据库连接的习惯</span><br></pre></td></tr></table></figure>

<ul>
<li>fetchone与fetchall的理解；举个例子:cursor是我们连接数据库的实例<br>fetchone()的使用:返回值是单个的元组,也就是一行记录,如果没有结果,那就会返回null</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cursor.execute(f&quot;select username,password,nickname from user where id=&#123;input&#125;&quot;)</span><br><span class="line">result=cursor.fetchone();  </span><br><span class="line">此时我们可以通过result[0],result[1],result[2]得到username,password,nickname</span><br></pre></td></tr></table></figure>
<p>fetchall()的使用:返回值是多个元组,即返回多个行记录,如果没有结果,返回的是()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cursor.execute(select * from user)</span><br><span class="line">result=cursor.fetchall();此时select得到的可能是多行记录,那么我们通过fetchall得到的就是多行记录,是一个二维元组</span><br><span class="line">((username1,password1,nickname1),(username2,password2,nickname2),(username3,password3,nickname))</span><br></pre></td></tr></table></figure>
<h3 id="第二种：pandas内置的read-sql"><a href="#第二种：pandas内置的read-sql" class="headerlink" title="第二种：pandas内置的read_sql"></a>第二种：pandas内置的read_sql</h3><p>  需要安装sqlalchemy,但是可以DataFrame的形式读出来，方便多了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda install sqlalchemy</span><br><span class="line">#或者</span><br><span class="line">pip install sqlalchemy</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">from sqlalchemy import create_engine</span><br><span class="line">def reader_sql(query,db=&#x27;myemployees&#x27;):</span><br><span class="line">    sql = query</span><br><span class="line">    engine = create_engine(f&#x27;mysql+pymysql://root:&#123;pwd&#125;@localhost:3306/&#123;db&#125;?charset=utf8&#x27;)</span><br><span class="line">    #格式一点不能错，依次是用户名，密码（###），主机名，端口号，要连接的数据库，指定编码</span><br><span class="line">    df = pd.read_sql(sql,engine)</span><br><span class="line">    return df</span><br><span class="line">df_departments = reader_sql(&#x27;select  * from departments&#x27;)#这里输出的是一个dataframe</span><br></pre></td></tr></table></figure>
<h2 id="2、写入数据"><a href="#2、写入数据" class="headerlink" title="2、写入数据"></a>2、写入数据</h2><h3 id="第一种：to-sql写入"><a href="#第一种：to-sql写入" class="headerlink" title="第一种：to_sql写入"></a>第一种：to_sql写入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">result.to_sql(name=&#x27;newtable&#x27;,con=engine,if_exists=&#x27;append&#x27;,index=False)</span><br><span class="line">#这里的index如果为True的话也会报错，数据库中没有索引列（建表的时候没有预留索引列的位置）</span><br><span class="line">#默认参数是fail，如果这张表本来存在的话，操作就会fail失败掉</span><br><span class="line">#不建议这种直接建表操作，这样的表中字段类型会有变化，不符合原先数据要求</span><br><span class="line">#建议在workbench中先create table并把所有字段的类型定义好，在使用to_sql进行写入</span><br></pre></td></tr></table></figure>
<ul>
<li>新建表设置好字段类型或者用cursor.execute执行建表语句后，就可以用to_sql写入了</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">result.to_sql(name=&#x27;new_table2&#x27;,con=engine,if_exists=&#x27;append&#x27;,index=False)</span><br><span class="line">#这里注意新建表的时候一定要把各个字段的类型搞准确，编码搞清楚不然没意识到出个错，很难受</span><br><span class="line">#如果重复执行这行代码的话，会导致插入的数据成倍数增加，因为你传入的append参数，会在原数据上接着添加</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">del result[&#x27;department_name&#x27;]#删掉一列后再进行写入</span><br><span class="line">result.to_sql(name=&#x27;new_table2&#x27;,con=engine,if_exists=&#x27;append&#x27;,index=False)</span><br><span class="line">#如果建表时在NN列未勾选上的话，不会报错，会发现原本的值数量多了一倍，且新增的数据中的department_name列均为空值</span><br><span class="line">#但如果建表时在NN列勾选上的话，表示该字段不允许为空值，就会报错</span><br><span class="line">#还有如果写入的数据字段多了，与建表时给定的字段数量不符也会报错</span><br></pre></td></tr></table></figure>
<ul>
<li>将excel中分sheet写入数据库</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import pymysql</span><br><span class="line">import pandas as pd</span><br><span class="line">from sqlalchemy import create_engine</span><br><span class="line">import xlrd</span><br><span class="line">file = r&#x27;C:\Users\sofia.xlsx&#x27;</span><br><span class="line">#分sheet写入数据库</span><br><span class="line"># 然后调用df.to_sql()函数将dataframe数据写入：</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot; 打开excel表格&quot;&quot;&quot;</span><br><span class="line">workbook = xlrd.open_workbook(file)</span><br><span class="line">sheet_names = workbook.sheet_names()</span><br><span class="line">for i in sheet_names :</span><br><span class="line">    data = pd.read_excel(file,sheet_name = i,index = False,encoding=&#x27;utf-8&#x27;)</span><br><span class="line">    data.to_sql(i,con=engine,if_exists=&#x27;replace&#x27;,index=False)</span><br></pre></td></tr></table></figure>

<ul>
<li>pd.read_sql()介绍</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pandas.read_sql(sql, con, index_col=None, coerce_float=True, params=None, parse_dates=None, columns=None, chunksize=None)</span><br><span class="line">各参数意义：</span><br><span class="line">sql:SQL命令字符串</span><br><span class="line">con：连接sql数据库的engine，一般可以用SQLalchemy或者pymysql之类的包建立</span><br><span class="line">index_col: 选择某一列作为index</span><br><span class="line">coerce_float:非常有用，将数字形式的字符串直接以float型读入</span><br><span class="line">parse_dates:将某一列日期型字符串转换为datetime型数据，与pd.to_datetime函数功能类似。可以直接提供需要转换的列名以默认的日期形式转换，也可以用字典的格式提供列名和转换的日期格式，比如&#123;column_name: format string&#125;（format string：&quot;%Y:%m:%H:%M:%S&quot;）。</span><br><span class="line">columns:要选取的列。一般没啥用，因为在sql命令里面一般就指定要选择的列了</span><br><span class="line">chunksize：如果提供了一个整数值，那么就会返回一个generator，每次输出的行数就是提供的值的大小。</span><br><span class="line">##read_sql本质上是read_sql_table、read_sql_query的统一方式。</span><br><span class="line">三者都return返回DataFrame。</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_sql_table.html#pandas.read_sql_table"><code>read_sql_table</code></a></p>
<p>Read SQL database table into a DataFrame.</p>
<p><a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_sql_query.html#pandas.read_sql_query"><code>read_sql_query</code></a></p>
<p>Read SQL query into a DataFrame.</p>
<p><a class="link"   target="_blank" rel="noopener" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.to_sql.html" >to_sql<i class="fas fa-external-link-alt"></i></a><br>主要有以下几个参数：</p>
<ul>
<li>  name: 输出的表名</li>
<li>  con: 与read_sql中相同</li>
<li>  if_exits： 三个模式：fail，若表存在，则不输出；replace：若表存在，覆盖原来表里的数据；append：若表存在，将数据写到原表的后面。默认为fail</li>
<li>  index：是否将df的index单独写到一列中</li>
<li>  index_label:指定列作为df的index输出，此时index为True</li>
<li>  chunksize： 同read_sql</li>
<li>dtype: 指定列的输出到数据库中的数据类型。字典形式储存：{column_name: sql_dtype}。常见的数据类型有sqlalchemy.types.INTEGER(), sqlalchemy.types.NVARCHAR(),sqlalchemy.Datetime()等，具体数据类型可以参考<a class="link"   target="_blank" rel="noopener" href="http://docs.sqlalchemy.org/en/latest/core/type_basics.html#sql-standard-and-multiple-vendor-types" >这里<i class="fas fa-external-link-alt"></i></a><br>  还是以写到mysql数据库为例：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df.to_sql(name=&#x27;table&#x27;, </span><br><span class="line">          con=con, </span><br><span class="line">          if_exists=&#x27;append&#x27;, </span><br><span class="line">          index=False,</span><br><span class="line">          dtype=&#123;&#x27;col1&#x27;:sqlalchemy.types.INTEGER(),</span><br><span class="line">                 &#x27;col2&#x27;:sqlalchemy.types.NVARCHAR(length=255),</span><br><span class="line">                 &#x27;col_time&#x27;:sqlalchemy.DateTime(),</span><br><span class="line">                 &#x27;col_bool&#x27;:sqlalchemy.types.Boolean</span><br><span class="line">          &#125;)</span><br></pre></td></tr></table></figure></li>
<li>*注：**如果不提供dtype,to_sql会自动根据df列的dtype选择默认的数据类型输出，比如字符型会以sqlalchemy.types.TEXT类型输出，相比NVARCHAR，TEXT类型的数据所占的空间更大，所以一般会指定输出为NVARCHAR；而如果df的列的类型为np.int64时，将会导致无法识别并转换成INTEGER型，需要事先转换成int类型（用map，apply函数可以方便的转换）。<br><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/arkenstone/p/6271923.html" >https://www.cnblogs.com/arkenstone/p/6271923.html<i class="fas fa-external-link-alt"></i></a></li>
</ul>
<h3 id="第二种：cursor-execute-直接写入"><a href="#第二种：cursor-execute-直接写入" class="headerlink" title="第二种：cursor.execute()直接写入"></a>第二种：cursor.execute()直接写入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#插入方法无需改动，传入一个动态变化的字典</span><br><span class="line">connect = pymysql.connect(host=&#x27;&#x27;,user=&#x27;&#x27;,db = &#x27;&#x27;,password=&#x27;&#x27;,port=3306,charset=&#x27;utf8&#x27;)</span><br><span class="line">cursor=connect.cursor()</span><br><span class="line">data = &#123;&quot;id&quot;:&#x27;100&#x27;,&#x27;name&#x27;:&#x27;Bob&#x27;&#125;</span><br><span class="line">table= &#x27;stuinfo&#x27;</span><br><span class="line">keys = &#x27;, &#x27;.join(data.keys())</span><br><span class="line">values = &#x27;, &#x27;.join([&#x27;%s&#x27;]*len(data))</span><br><span class="line">sql = f&quot;insert into &#123;table&#125;(&#123;keys&#125;) values(&#123;values&#125;)&quot;</span><br><span class="line">try:</span><br><span class="line">    cursor.execute(sql,tuple(data.values()))</span><br><span class="line">    connect.commit()</span><br><span class="line">    cursor.execute(&#x27;select * from &#123;table&#125;&#x27;.format(table=table))</span><br><span class="line">    print(&#x27;执行成功&#x27;,cursor.fetchall())</span><br><span class="line">except:</span><br><span class="line">    print(&quot;插入失败，数据回滚&quot;)</span><br><span class="line">    connect.rollback()</span><br></pre></td></tr></table></figure>
<h2 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#更新，把Bon的age更新为28</span><br><span class="line">sql = &quot;update stuinfo set id=%s where name = %s&quot;</span><br><span class="line">cursor.execute(sql,(&quot;28&quot;,&#x27;Bob&#x27;))</span><br><span class="line">connect.commit()</span><br><span class="line">cursor.execute(&#x27;select * from stuinfo&#x27;)</span><br><span class="line">print(&quot;Successful:&quot;,cursor.fetchall())</span><br></pre></td></tr></table></figure>
<h2 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#删除数据</span><br><span class="line">sql = &quot;delete from stuinfo where id &gt;=10&quot;</span><br><span class="line">cursor.execute(sql)</span><br><span class="line">connect.commit()</span><br><span class="line">cursor.execute(&quot;select * from stuinfo&quot;)</span><br><span class="line">print(cursor.fetchall())</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/05/05/python%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%9Aselenium%E7%88%AC%E8%99%AB%E3%80%81%E8%87%AA%E5%8A%A8%E5%8C%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WenGe Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="弦好想断">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/05/python%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%9Aselenium%E7%88%AC%E8%99%AB%E3%80%81%E8%87%AA%E5%8A%A8%E5%8C%96/" class="post-title-link" itemprop="url">python数据采集：selenium爬虫、自动化</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-05-05 10:34:57" itemprop="dateCreated datePublished" datetime="2021-05-05T10:34:57+08:00">2021-05-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-03 14:07:55" itemprop="dateModified" datetime="2022-04-03T14:07:55+08:00">2022-04-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">中文文档https://python-selenium-zh.readthedocs.io/zh_CN/latest/</span><br></pre></td></tr></table></figure>
<p>装包：pip install selenium<br>下载chrome：<a class="link"   target="_blank" rel="noopener" href="https://www.google.cn/chrome/" >https://www.google.cn/chrome/<i class="fas fa-external-link-alt"></i></a><br>下驱动：<a class="link"   target="_blank" rel="noopener" href="https://chromedriver.storage.googleapis.com/index.html" >https://chromedriver.storage.googleapis.com/index.html<i class="fas fa-external-link-alt"></i></a>  注意浏览器驱动 必须要和浏览器版本匹配<br>这是个zip包，下载下来之后，解压里面的程序文件 chromedriver.exe 到scripts路径下<br>跑一下看看感觉来了没有</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from selenium import webdriver</span><br><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line">from selenium.webdriver.common.keys import Keys</span><br><span class="line">from selenium.webdriver.support import expected_conditions as EC</span><br><span class="line">from selenium.webdriver.support.wait import WebDriverWait</span><br><span class="line"></span><br><span class="line">browser = webdriver.Chrome()</span><br><span class="line">try:</span><br><span class="line">    browser.get(&#x27;https://www.baidu.com&#x27;)</span><br><span class="line">    input = browser.find_element_by_id(&#x27;kw&#x27;)</span><br><span class="line">    input.send_keys(&#x27;Python&#x27;)</span><br><span class="line">    input.send_keys(Keys.ENTER)</span><br><span class="line">    wait = WebDriverWait(browser, 10)</span><br><span class="line">    wait.until(EC.presence_of_element_located((By.ID, &#x27;content_left&#x27;)))</span><br><span class="line">    print(browser.current_url)</span><br><span class="line">    print(browser.get_cookies())</span><br><span class="line">    print(browser.page_source)</span><br><span class="line">finally:hexo</span><br><span class="line">    browser.close()</span><br></pre></td></tr></table></figure>
<p>不可能一下就会的，慢慢来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/weixin_54733110/article/details/119027005  python万字博文教你玩嗨selenium库</span><br><span class="line">https://mp.weixin.qq.com/s?__biz=MzI0OTc0MzAwNA==&amp;mid=2247487680&amp;idx=1&amp;sn=e40947f382116ff59761f250ee45dce3  模拟登录淘宝</span><br><span class="line">https://www.pianshen.com/article/345981989/  判断元素16种方法expected_conditions</span><br><span class="line">https://github.com/Python3WebSpider/Python3WebSpider/blob/master/7.1-Selenium%E7%9A%84%E4%BD%BF%E7%94%A8.md</span><br><span class="line">http://www.byhy.net/tut/auto/selenium/01/这个作者写的很好</span><br><span class="line">https://www.bilibili.com/video/av64421994/?p=1简直是保姆级教学，</span><br><span class="line">希望你学会了不要乱搞</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/04/05/python%E5%8A%9E%E5%85%AC%E8%87%AA%E5%8A%A8%E5%8C%96%EF%BC%9A%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WenGe Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="弦好想断">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/05/python%E5%8A%9E%E5%85%AC%E8%87%AA%E5%8A%A8%E5%8C%96%EF%BC%9A%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81/" class="post-title-link" itemprop="url">python办公自动化：邮件发送</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-05 10:24:12" itemprop="dateCreated datePublished" datetime="2021-04-05T10:24:12+08:00">2021-04-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-03 14:09:35" itemprop="dateModified" datetime="2022-04-03T14:09:35+08:00">2022-04-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>邮件批量发送<br>调用smtp.exmail.qq.com批量自动发送邮件<br>注意文件路径，逗号分隔符，csv中不要有多余回车和空格<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line">import csv</span><br><span class="line">import smtplib</span><br><span class="line">import pandas as pd</span><br><span class="line">import numpy as np</span><br><span class="line">from email.mime.base import MIMEBase</span><br><span class="line">from email.mime.image import MIMEImage</span><br><span class="line">from email.utils import formataddr</span><br><span class="line">from email import encoders</span><br><span class="line">import time,datetime</span><br><span class="line">import smtplib</span><br><span class="line">import email.mime.multipart</span><br><span class="line">import email.mime.text</span><br><span class="line">from email.mime.text import MIMEText</span><br><span class="line">from email.mime.multipart import MIMEMultipart</span><br><span class="line">from email.mime.application import MIMEApplication</span><br><span class="line">from email.header import Header</span><br><span class="line"></span><br><span class="line">def get_current_date():</span><br><span class="line">    &quot;&quot;&quot;获取当前时间&quot;&quot;&quot;</span><br><span class="line">    return str(time.strftime(&#x27;%Y%m%d&#x27;))</span><br><span class="line"></span><br><span class="line">def getAddrBook(addrBook):</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">        @作用：根据输入的CSV文件，形成相应的通讯录字典</span><br><span class="line">        @返回：字典类型，name为人名，value为对应的邮件地址</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    with open(addrBook,&#x27;r&#x27;,encoding=&#x27;UTF-8&#x27;) as addrFile:</span><br><span class="line">        #将文件名和邮件接收人邮箱地址分行存放在csv文件中，用逗号分隔</span><br><span class="line">        reader = csv.reader(addrFile)</span><br><span class="line">        name = []</span><br><span class="line">        value = []</span><br><span class="line">        for row in reader:</span><br><span class="line">            name.append(row[0])</span><br><span class="line">            value.append(row[1])</span><br><span class="line">    addrs = dict(zip(name, value))</span><br><span class="line">    return addrs</span><br><span class="line"></span><br><span class="line">def send_email(inputpath,smtpHost,port,sendAddr,password,recipientAddrs, subject, content,attachfilename):</span><br><span class="line">    &quot;&quot;&quot;定义并配置好发邮件的函数&quot;&quot;&quot;</span><br><span class="line">    msg = email.mime.multipart.MIMEMultipart()</span><br><span class="line">    msg[&#x27;from&#x27;] =sendAddr #发件人</span><br><span class="line">    msg[&#x27;to&#x27;] =recipientAddrs #接收人</span><br><span class="line">    # msg[&#x27;cc&#x27;] =cc_name #抄送人名称</span><br><span class="line">    msg[&#x27;subject&#x27;] =subject #主题</span><br><span class="line">    content=content</span><br><span class="line">    txt = email.mime.text.MIMEText(content, &#x27;plain&#x27;, &#x27;UTF-8&#x27;)</span><br><span class="line">    msg.attach(txt)</span><br><span class="line">    print(&quot;准备添加附件...&quot;)</span><br><span class="line">    inputfile=inputpath+attachfilename #文件路径</span><br><span class="line">    part = MIMEText(open(inputfile,&#x27;rb&#x27;).read(),&#x27;base64&#x27;, &#x27;utf-8&#x27;)</span><br><span class="line">    part[&quot;Content-Type&quot;] = &#x27;application/octet-stream&#x27;</span><br><span class="line">    part.add_header(&#x27;Content-Disposition&#x27;, &#x27;attachment&#x27;, filename=Header(attachfilename,&#x27;utf-8&#x27;).encode())</span><br><span class="line">    msg.attach(part)</span><br><span class="line">    smtp = smtplib.SMTP_SSL(smtpHost, port)</span><br><span class="line">    smtp.login(sendAddr, password)</span><br><span class="line">    smtp.sendmail(sendAddr, recipientAddrs.split(&#x27;,&#x27;), str(msg))   #+cc_name.split(&#x27;,&#x27;)</span><br><span class="line">    #print(&quot;发送成功！&quot;)</span><br><span class="line">    smtp.quit()</span><br><span class="line"></span><br><span class="line">if __name__==&#x27;__main__&#x27;:</span><br><span class="line">    #这里需要定义send_email函数中传入的所有变量</span><br><span class="line">    inputpath = &quot;r&#x27;D:/&quot; #数据存放的文件路径（这里是绝对路径）</span><br><span class="line">    smtpHost = &#x27;smtp.exmail.qq.com&#x27;  # 默认服务器地址及端口</span><br><span class="line">    port=465</span><br><span class="line">    sendAddr =&quot;&quot;    #自己也就是发件人的邮箱账号</span><br><span class="line">    password = &quot;&quot;   #自己的邮箱密码</span><br><span class="line">    subject=&quot; &quot;+current_date  #主题+当前日期</span><br><span class="line">    content=&#x27;&#x27;&#x27;附件为测试文件&#x27;&#x27;&#x27;+current_date# 正文内容+当前日期</span><br><span class="line"></span><br><span class="line">    addrBook=r&#x27;D:\邮箱联系人表单.csv&#x27;  #联系人表单文件路径</span><br><span class="line">    addrs=getAddrBook(addrBook)</span><br><span class="line">    for i in addrs:</span><br><span class="line">        attachfilename=i+&#x27;.xlsx&#x27; #将要发送的文件添加为附件</span><br><span class="line">        recipientAddrs=addrs[i] #接收人的邮箱地址</span><br><span class="line">        result = os.path.exists(inputpath+i+&#x27;.xlsx&#x27;) #判断当前目录是否存在该文件</span><br><span class="line">        if result:</span><br><span class="line">            #存在就执行邮件</span><br><span class="line">            send_email(inputpath,smtpHost,port,sendAddr,password,recipientAddrs,</span><br><span class="line">            subject,content,attachfilename)</span><br><span class="line">            print ((&#x27;发给 %s 的邮件执行成功&#x27;) %(recipientAddrs))</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<p>这里也看到有使用126邮箱的smtp服务器：’smtp.126.com’<br><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42350212/article/details/118751583" >https://blog.csdn.net/weixin_42350212/article/details/118751583<i class="fas fa-external-link-alt"></i></a><br>Python smtp发送邮件怎么设置抄送人<br><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/shiyixirui/p/14692146.html" >https://www.cnblogs.com/shiyixirui/p/14692146.html<i class="fas fa-external-link-alt"></i></a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/06/python%E5%8A%9E%E5%85%AC%E8%87%AA%E5%8A%A8%E5%8C%96%EF%BC%9A%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WenGe Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="弦好想断">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/06/python%E5%8A%9E%E5%85%AC%E8%87%AA%E5%8A%A8%E5%8C%96%EF%BC%9A%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C/" class="post-title-link" itemprop="url">python办公自动化：文件和目录操作</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-06 23:07:45" itemprop="dateCreated datePublished" datetime="2021-03-06T23:07:45+08:00">2021-03-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-03 14:09:17" itemprop="dateModified" datetime="2022-04-03T14:09:17+08:00">2022-04-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br></pre></td></tr></table></figure>
<h3 id="创建目录结构"><a href="#创建目录结构" class="headerlink" title="创建目录结构"></a>创建目录结构</h3><ul>
<li>os.makedirs 可以递归的创建目录结构，比如<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.makedirs(&#x27;tmp/python/fileop&#x27;,exist_ok=True)</span><br></pre></td></tr></table></figure>
在当前工作目录下面创建 tmp目录，在tmp目录下面再创建 python目录，在Python目录下面再创建fileop目录；exist_ok=True 指定了，如果某个要创建的目录已经存在，也不报错</li>
</ul>
<h3 id="删除文件或目录"><a href="#删除文件或目录" class="headerlink" title="删除文件或目录"></a>删除文件或目录</h3><p>os.remove 可以删除一个文件，比如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.remove(&#x27;sdf.py&#x27;)</span><br></pre></td></tr></table></figure>
<p>shutil.rmtree() 可以递归的删除某个目录所有的子目录和子文件 比如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import shutil</span><br><span class="line">shutil.rmtree(&#x27;tmp&#x27;, ignore_errors=True)</span><br></pre></td></tr></table></figure>
<p>注意：参数 ignore_errors=True 保证如果目录不为空，不会抛出异常。</p>
<h3 id="拷贝文件"><a href="#拷贝文件" class="headerlink" title="拷贝文件"></a>拷贝文件</h3><p>shutil 模块里面有很多 目录文件操作的函数<br>拷贝文件，可以使用shutil模块的copyfile函数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from shutil import copyfile</span><br><span class="line"># 拷贝 d:/tools/first.py 到 e:/first.py</span><br><span class="line">copyfile(&#x27;d:/tools/first.py&#x27;, &#x27;e:/first.py&#x27;)</span><br></pre></td></tr></table></figure>
<p>注意，如果拷贝前，e:/first.py 已经存在，则会被拷贝覆盖，所以使用该函数一定要小心。<br>###拷贝目录<br>如果我们要拷贝一个目录里面所有的内容（包括子目录和文件、子目录里面的子目录和文件，等等）到另外一个目录中，可以使用 shutil的copytree函数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from shutil import copytree</span><br><span class="line"># 拷贝 d:/tools/aaa 目录中所有的内容 到 e:/bbb 中</span><br><span class="line">copytree(&#x27;d:/tools/aaa&#x27;, &#x27;e:/new/bbb&#x27;)</span><br></pre></td></tr></table></figure>
<p>注意拷贝前， 目标目录必须 不存在 ，否则会报错。</p>
<p>上面的代码执行前面，如果 e:/new/bbb 已经存在，执行到copytree时，就会报错</p>
<p>上面的代码执行前面，如果 e:/new 这个目录都不存在，执行到copytree时，就会 创建 e:/new 目录，再创建 e:/new/bbb 目录，再拷贝 d:/tools/aaa 目录中所有的内容 到 e:/new/bbb 中。</p>
<p>上面的代码执行前面，如果 e:/new 这个目录存在，但是 e:/new/bbb 不存在，执行到copytree时，就只会 创建 e:/new/bbb ，再拷贝 d:/tools/aaa 目录中所有的内容 到 e:/new/bbb 中。<br>###修改文件名、目录名<br>要修改文件名、目录名，可以使用os模块的rename函数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 修改目录名 d:/tools/aaa 为 d:/tools/bbb</span><br><span class="line">os.rename(&#x27;d:/tools/aaa&#x27;,&#x27;d:/tools/bbb&#x27;)</span><br><span class="line"></span><br><span class="line"># 修改文件名 d:/tools/first.py 为 d:/tools/second.py</span><br><span class="line">os.rename(&#x27;d:/tools/first.py&#x27;,&#x27;d:/tools/second.py&#x27;)</span><br></pre></td></tr></table></figure>

<h3 id="对文件路径名的操作"><a href="#对文件路径名的操作" class="headerlink" title="对文件路径名的操作"></a>对文件路径名的操作</h3><p>对于文件名的操作，比如 获取文件名称，文件所在目录，文件路径的拼接等，都可以使用 os.path 模块。</p>
<p>通常我们喜欢使用格式化字符串的方法来做文件路径的拼接，但是如果你的程序需要在Linux、Windows等多个平台运行，它们的路径的分隔符是不同的，Windows上是 <code>\</code> , 而 Linux上是 <code>/</code>。</p>
<p>这时，我们应该使用 os.path 模块。 它能够自动处理类似 Data/data.csv 和 Data\data.csv 这样的文件路径差异。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">path = &#x27;/Users/beazley/Data/data.csv&#x27;</span><br><span class="line"># 获取路径中的文件名部分</span><br><span class="line">os.path.basename(path)</span><br><span class="line">&#x27;data.csv&#x27;</span><br><span class="line"># 获取路径中的目录部分</span><br><span class="line">os.path.dirname(path)</span><br><span class="line">&#x27;/Users/beazley/Data&#x27;</span><br><span class="line"># 文件路径的拼接</span><br><span class="line">os.path.join(&#x27;tmp&#x27;, &#x27;data&#x27;, os.path.basename(path))</span><br><span class="line">&#x27;tmp/data/data.csv&#x27;</span><br></pre></td></tr></table></figure>
<h3 id="判断文件、目录是否存在"><a href="#判断文件、目录是否存在" class="headerlink" title="判断文件、目录是否存在"></a>判断文件、目录是否存在</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">os.path.exists(&#x27;d:/systems/cmd.exe&#x27;)</span><br><span class="line">os.path.exists(&#x27;d:/systems&#x27;)</span><br></pre></td></tr></table></figure>
<p>exists方法返回值为True表示 存在，否则表示不存在。<br>如果你要判断指定路径是否是文件，可以这样<br>os.path.isfile(‘d:/systems/cmd.exe’)# 返回值为True 表示是文件<br>如果你要判断指定路径是否是目录，可以这样<br>os.path.isdir(‘d:/systems’)#返回值为True 表示是目录</p>
<p>###文件大小和修改日期</p>
<ul>
<li><p>返回文件大小<br>os.path.getsize(‘file1’)<br>3669</p>
</li>
<li><p>返回文件的最后修改日期，是秒时间<br>参考下一章 日期和时间 里面的内容<br>os.path.getmtime(‘file1’)<br>1272478234.0</p>
</li>
<li><p>可以把秒时间 转化为日期时间<br>import time<br>time.ctime(os.path.getmtime(‘/etc/passwd’))<br>‘Wed Apr 28 13:10:34 2010’</p>
</li>
</ul>
<p>###当前工作目录<br>当前工作目录的路径：<br>wd = os.getcwd()<br>改变当前工作目录到另外的路径：<br>os.chdir(path)<br>参数就是 新的当前工作目录 路径地址。</p>
<p>###递归的遍历目录下面所有的文件<br>获取某个目录中所有的 文件， 包括子目录里面的文件。 可以使用 os库中的walk方法<br>比如我们要得到某个目录下面所有的子目录 和所有的文件，存放在两个列表中<br> os.walk(top[, topdown=True[, onerror=None[, followlinks=False]]])<br>    top ：是你所要遍历的目录的地址, 返回的是一个三元组 (dirpath, dirnames, filenames)<br>    topdown ：可选，True则优先遍历 top 文件夹，与top 文件夹中每一个子目录；否则优先遍历 top 的子目录(默认为开启)。<br>    onerror ：可选，需要一个 callable 对象，当 walk 需要异常时，会调用<br>    followlinks ：可选，如果为 True，则会遍历目录下的快捷方式(linux 下是软连接 symbolic link )实际所指的目录(默认关闭)，如果为 False，则优先遍历 top 的子目录；</p>
<ul>
<li>得到某个目录下所有文件的全路径<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line"># 目标目录</span><br><span class="line">targetDir = r&#x27;d:\tmp\util\dist\check&#x27;</span><br><span class="line">for (dirpath, dirnames, filenames) in os.walk(targetDir):</span><br><span class="line">    for fn in filenames:</span><br><span class="line">        # 把 dirpath 和 每个文件名拼接起来 就是全路径</span><br><span class="line">        fpath = os.path.join(dirpath, fn)</span><br><span class="line"># dirpath 代表当前遍历到的目录名</span><br><span class="line"># dirnames 是列表对象，存放当前dirpath中的所有子目录名</span><br><span class="line"># filenames 是列表对象，存放当前dirpath中的所有文件名</span><br></pre></td></tr></table></figure>
<h3 id="得到目录中所有的文件和子目录名"><a href="#得到目录中所有的文件和子目录名" class="headerlink" title="得到目录中所有的文件和子目录名"></a>得到目录中所有的文件和子目录名</h3>listdir返回的是该目录下面所有的文件和子目录。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 目标目录</span><br><span class="line">targetDir = r&#x27;d:\tmp\util\dist\check&#x27;</span><br><span class="line">files =  os.listdir(targetDir)</span><br><span class="line">print(files)</span><br></pre></td></tr></table></figure>
如果只需要获取目录中所有的文件，或者只需要子目录<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">from os.path import isfile, join,isdir</span><br><span class="line"># 目标目录</span><br><span class="line">targetDir = r&#x27;d:\tmp\util\dist\check&#x27;</span><br><span class="line"># 所有的文件</span><br><span class="line">print([f for f in os.listdir(targetDir) if isfile(join(targetDir, f))])</span><br><span class="line"># 所有的目录</span><br><span class="line">print([f for f in os.listdir(targetDir) if isdir(join(targetDir, f))])</span><br></pre></td></tr></table></figure>
###得到目录中指定扩展名的文件和子目录<br>可以使用glob库<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import glob</span><br><span class="line">exes = glob.glob(r&#x27;d:\tmp\*.txt&#x27;)</span><br><span class="line">print(exes)</span><br></pre></td></tr></table></figure>
<a class="link"   target="_blank" rel="noopener" href="http://www.byhy.net/tut/py/extra/file_dir" >http://www.byhy.net/tut/py/extra/file_dir<i class="fas fa-external-link-alt"></i></a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/28/python%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90%EF%BC%88apriori%E7%AE%97%E6%B3%95%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WenGe Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="弦好想断">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/28/python%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90%EF%BC%88apriori%E7%AE%97%E6%B3%95%EF%BC%89/" class="post-title-link" itemprop="url">python关联分析（apriori算法）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-02-28 22:05:20" itemprop="dateCreated datePublished" datetime="2021-02-28T22:05:20+08:00">2021-02-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-03 14:07:30" itemprop="dateModified" datetime="2022-04-03T14:07:30+08:00">2022-04-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>若两个或多个变量的取值之间存在某种规律性，就称为关联。关联规则是寻找在同一个事件中出现的不同项的相关性，比如在一次购买活动中所买不同商品的相关性。例如：“在购买计算机的顾客中，有30％的人也同时购买了打印机”。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.60btv7guvhxc.png"
                     
                ></p>
<p>一个样本称为一个“事务”<br>每个事务由多个属性来确定，这里的属性称为“项”<br>多个项组成的集合称为“项集”<br>####由k个项构成的集合<br>{牛奶}、{啤酒}都是1-项集；<br>{牛奶，果冻}是2-项集；<br>{啤酒，面包，牛奶}是3-项集<br>####X==&gt;Y含义：<br>X和Y是项集<br>X称为规则前项（antecedent）<br>Y称为规则后项（consequent）<br>####支持度（support）：一个项集或者规则在所有事务中出现的频率，σ(X):表示项集X的支持度计数<br>项集X的支持度：s(X)=σ(X)/N<br>规则X==&gt;Y表示物品集X对物品集Y的支持度，也就是物品集X和物品集Y同时出现的概率<br>某天共有100个顾客到商场购买物品，其中有30个顾客同时购买了啤酒和尿布，那么上述的关联规则的支持度就是30％<br>####置信度（confidence）：确定Y在包含X的事务中出现的频繁程度。c(X → Y) = σ(X∪Y)/σ(X)<br>p（Y│X）＝p（XY）/p(X)。<br>置信度反应了关联规则的可信度—购买了项目集X中的商品的顾客同时也购买了Y中商品的可能性有多大<br>购买薯片的顾客中有50％的人购买了可乐,则置信度为50％</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.4qn34mu3vvr4.png"
                     
                ></p>
<p>####(X , Y)==&gt;Z :<br>支持度:交易中包含{X 、 Y 、 Z}的可能性<br>置信度:包含{X 、 Y}的交易中也包含Z的条件概率<br>####设最小支持度为50%, 最小可信度为 50%, 则可得到 :<br>A==&gt;C (50%, 66.6%)<br>C==&gt;A (50%, 100%)</p>
<p>若关联规则X-&gt;Y的支持度和置信度分别大于或等于用户指定的最小支持率minsupport和最小置信度minconfidence，则称关联规则X-&gt;Y为强关联规则，否则称关联规则X-&gt;Y为弱关联规则。</p>
<p>####提升度（lift）：物品集A的出现对物品集B的出现概率发生了多大的变化<br>lift（A==&gt;B）=confidence（A==&gt;B）/support(B)=p(B|A)/p(B)<br>现在有** 1000 ** 个消费者，有** 500** 人购买了茶叶，其中有** 450人同时** 购买了咖啡，另** 50人** 没有。由于** confidence(茶叶=&gt;咖啡)=450/500=90%** ，由此可能会认为喜欢喝茶的人往往喜欢喝咖啡。但如果另外没有购买茶叶的** 500人** ，其中同样有** 450人** 购买了咖啡，同样是很高的** 置信度90%** ,由此，得到不爱喝茶的也爱喝咖啡。这样看来，其实是否购买咖啡，与有没有购买茶叶并没有关联，两者是相互独立的，其** 提升度90%/[(450+450)/1000]=1** 。<br>由此可见，lift正是弥补了confidence的这一缺陷，if lift=1,X与Y独立，X对Y出现的可能性没有提升作用，其值越大(lift&gt;1),则表明X对Y的提升程度越大，也表明关联性越强。<br>####Leverage 与 Conviction的作用和lift类似，都是值越大代表越关联<br>Leverage : P(A,B)-P(A)P(B)<br>Conviction:P(A)P(!B)/P(A,!B）<br>####所有指标的计算公式：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.1iip63ea95vk.png"
                     
                ></p>
<p>接下来获取电影数据集中个电影类型之间的关联关系：<br>anaconda安装mlxtend包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install -c conda-forge mlxtend</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">from mlxtend.frequent_patterns import apriori</span><br><span class="line">from mlxtend.frequent_patterns import association_rules</span><br><span class="line">movie_genres = pd.DataFrame(data,columns=[&#x27;original_title&#x27;,&#x27;genres&#x27;])</span><br><span class="line">movies_ohe = movie_genres.drop(&#x27;genres&#x27;,1).join(movie_genres.genres.str.get_dummies())</span><br><span class="line">movies_ohe.shape#(10866, 21)</span><br><span class="line">movies_ohe.set_index([&#x27;original_title&#x27;],inplace=True)</span><br><span class="line">frequent_itemsets_movies = apriori(movies_ohe,use_colnames=True, min_support=0.025)</span><br><span class="line">result = [i for i in frequent_itemsets_movies.itemsets if len(i)&gt;1]</span><br><span class="line">len(result)#37</span><br><span class="line">rules_movies =  association_rules(frequent_itemsets_movies, metric=&#x27;lift&#x27;, min_threshold=1.25)</span><br><span class="line">rules_movies[(rules_movies.lift&gt;4)].sort_values(by=[&#x27;lift&#x27;], ascending=False)</span><br></pre></td></tr></table></figure>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.70uir8omojk0.png"
                     
                ></p>
<p>也挺符合常理哈。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/24/%E6%88%91%E4%BB%AC%E8%BF%99%E6%A0%B7%E7%9A%84%E4%BA%BA%EF%BC%8C%E8%B0%88%E7%88%B1%E9%83%BD%E5%A4%AA%E5%A5%A2%E4%BE%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WenGe Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="弦好想断">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/24/%E6%88%91%E4%BB%AC%E8%BF%99%E6%A0%B7%E7%9A%84%E4%BA%BA%EF%BC%8C%E8%B0%88%E7%88%B1%E9%83%BD%E5%A4%AA%E5%A5%A2%E4%BE%88/" class="post-title-link" itemprop="url">我们这样的人，谈爱都太奢侈</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-24 11:17:06" itemprop="dateCreated datePublished" datetime="2020-09-24T11:17:06+08:00">2020-09-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-12-20 13:57:48" itemprop="dateModified" datetime="2021-12-20T13:57:48+08:00">2021-12-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>爱是人类的本能，可是成年人的世界里，所谓的真心，更多的换来的却是失落与沮丧，渐渐的他们学会了伪装与克制，变得沉默且凉薄。前几天和朋友闲聊，突然听到现如今找女朋友就像找大熊猫一样，哈哈哈，还是大学的时候投资好啊，现在估计早都不担心了。</p>
<p>房子带来的安稳，汽车带来的便捷，手机平板带来的时尚，不早不晚的都让九零后赶上了，他们也许是物质体验最丰富的一代人，但同时也会是对物质需求最挑剔的一代人。同学不满领导安排毅然辞去了干了不满五个月的工作；朋友上次分手后，突然告诉我决定今年国庆结婚，和一个认识半年左右的女孩；从小一起长大的兄弟在犹豫该不该留在大城市发展，毕竟对于房价有时候也会低声苦笑。</p>
<p>雷军先生说过：“现在的物质已经很丰富了，现在的年轻人面对的可能更多的是精神上的痛苦”。人口比例失衡带来的红利，就像是资本家看上的蓝海市场，在物质与精神的两相施压下，猫猫狗狗都成了家居必备物种。谁能想到许多年后的今天人类会隔着彩色的屏幕去感受人情冷暖，体验世态炎凉。物欲横流的世界，浮躁成了这个时代最真实的写照。我们都想要牵了手就能结婚的爱情，却活在了一个上了床都不一定有结果的年代。那个男人他终究还是没有活成你希望的样子，可是你知道吗，在他会鼓起勇气和你表达之前，真的是会考虑现在和未来的呀。为了能配得上你，都还在沉住气不停的坚持呢。</p>
<p>有时候会有一种奇怪的感受，如果说读书时代遇到问题所面对的失落，是为了锻炼克服困难的能力，从而学习到更好的思维方式；参加高考上大学遭遇就业压力所承受的焦虑，是要鞭策自己为了过上更好的生活实现所谓的个人理想而努力。但当你真正走上社会的那一霎那，发现一切都不像你想象得那么有条有理，你可能还是会需要蛰伏很长一段时间。你拼尽全力的想要去缩短需要奋斗的距离，却还是会难以扛住资本家构造蓝图时行业给出的亲民价。我们这样的人，谈爱都太奢侈。</p>
<p>就写到这吧，闲来几笔，一个人还是要心无所恃，随遇而安。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/16/python-%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88%E5%AD%A6%E7%9A%84%E6%98%AF%E6%80%9D%E7%BB%B4%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WenGe Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="弦好想断">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/16/python-%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88%E5%AD%A6%E7%9A%84%E6%98%AF%E6%80%9D%E7%BB%B4%EF%BC%89/" class="post-title-link" itemprop="url">python-学生信息管理系统（学的是思维）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-16 18:35:07" itemprop="dateCreated datePublished" datetime="2020-09-16T18:35:07+08:00">2020-09-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-03 14:06:13" itemprop="dateModified" datetime="2022-04-03T14:06:13+08:00">2022-04-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="学生管理系统应具备的功能"><a href="#学生管理系统应具备的功能" class="headerlink" title="学生管理系统应具备的功能"></a>学生管理系统应具备的功能</h3><ul>
<li>添加学生及成绩信息</li>
<li>将学生信息保存到文件中</li>
<li>修改和删除学生信息</li>
<li>查询学生信息</li>
<li>根据学生成绩进行排序</li>
<li>统计学生的总分</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/image-20211219123240293.1zbrdjhj57ts.png"
                     
                ></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">filename = &#x27;student.txt&#x27;</span><br><span class="line">def main():</span><br><span class="line">    while True:</span><br><span class="line">        menum()</span><br><span class="line">        choice = int(input(&quot;请选择:&quot;))</span><br><span class="line">        if choice in [0,1,2,3,4,5,6,7]:</span><br><span class="line">            if choice==0:</span><br><span class="line">                answer = input(&quot;您确定要退出系统吗?y/n&quot;)</span><br><span class="line">                if answer == &#x27;y&#x27; or answer == &#x27;Y&#x27;:</span><br><span class="line">                    print(&quot;谢谢您的使用！&quot;)</span><br><span class="line">                    break #退出系统</span><br><span class="line">                else:</span><br><span class="line">                    continue</span><br><span class="line">            elif choice==1:</span><br><span class="line">                insert()</span><br><span class="line">            elif choice==2:</span><br><span class="line">                search()</span><br><span class="line">            elif choice==3:</span><br><span class="line">                delete()</span><br><span class="line">            elif choice==4:</span><br><span class="line">                modify()</span><br><span class="line">            elif choice ==5:</span><br><span class="line">                sort()</span><br><span class="line">            elif choice ==6:</span><br><span class="line">                total()</span><br><span class="line">            elif choice==7:</span><br><span class="line">                show()</span><br><span class="line">def menum():</span><br><span class="line">    print(&quot;===============================学生信息管理系统===============================&quot;)</span><br><span class="line">    print(&quot;----------------------------------功能菜单-----------------------------------&quot;)</span><br><span class="line">    print(&quot;\t\t\t\t\t\t1.录入学生信息&quot;)</span><br><span class="line">    print(&quot;\t\t\t\t\t\t2.查找学生信息&quot;)</span><br><span class="line">    print(&quot;\t\t\t\t\t\t3.删除学生信息&quot;)</span><br><span class="line">    print(&quot;\t\t\t\t\t\t4.修改学生信息&quot;)</span><br><span class="line">    print(&quot;\t\t\t\t\t\t5.排序&quot;)</span><br><span class="line">    print(&quot;\t\t\t\t\t\t6.统计学生总人数&quot;)</span><br><span class="line">    print(&quot;\t\t\t\t\t\t7.显示所有学生信息&quot;)</span><br><span class="line">    print(&quot;\t\t\t\t\t\t0.退出&quot;)</span><br><span class="line">    print(&quot;----------------------------------------------------------------------------&quot;)</span><br><span class="line"></span><br><span class="line">def save(lst):</span><br><span class="line">    try:</span><br><span class="line">        stu_txt = open(filename,&#x27;a&#x27;,encoding=&#x27;utf-8&#x27;)#以追加的模式进行打开</span><br><span class="line">    except:</span><br><span class="line">        stu_txt = open(filename,&#x27;w&#x27;,encoding = &#x27;utf-8&#x27;)</span><br><span class="line">    for item in lst:</span><br><span class="line">        stu_txt.write(str(item)+&#x27;\n&#x27;)</span><br><span class="line">    stu_txt.close()</span><br><span class="line"></span><br><span class="line">def insert():</span><br><span class="line">    student_list = []</span><br><span class="line">    while True:</span><br><span class="line">        id = input(&#x27;请输入ID(如1001):&#x27;)</span><br><span class="line">        if not id:</span><br><span class="line">            break</span><br><span class="line">        name = input(&quot;请输入姓名:&quot;)</span><br><span class="line">        if not name:</span><br><span class="line">            break</span><br><span class="line">        try:</span><br><span class="line">            english_score = int(input(&quot;请输入英语成绩:&quot;))</span><br><span class="line">            python_score= int(input(&quot;请输入Python成绩:&quot;))</span><br><span class="line">            java_score = int(input(&quot;请输入Java成绩:&quot;))</span><br><span class="line">        except:</span><br><span class="line">            print(&quot;输入无效，不是整数类型，请重新输入...&quot;)</span><br><span class="line">            continue</span><br><span class="line">        #将录入的学生信息保存到字典中</span><br><span class="line">        student = &#123;&#x27;id&#x27;:id,&#x27;name&#x27;:name,&#x27;english&#x27;:english_score,&#x27;python&#x27;:python_score,&#x27;java&#x27;:java_score&#125;</span><br><span class="line">        #将学生信息添加到列表中</span><br><span class="line">        student_list.append(student)</span><br><span class="line">        answer = input(&quot;是否将继续添加？y/n\n&quot;)</span><br><span class="line">        if answer==&#x27;y&#x27;:</span><br><span class="line">            continue</span><br><span class="line">        else:</span><br><span class="line">            break</span><br><span class="line">    #调用save()函数</span><br><span class="line">    save(student_list)</span><br><span class="line">    print(&quot;学生信息录入完毕！！！&quot;)</span><br><span class="line"></span><br><span class="line">def search():</span><br><span class="line">    student_query = []</span><br><span class="line">    while True:</span><br><span class="line">        id = &#x27;&#x27;</span><br><span class="line">        name = &#x27;&#x27;</span><br><span class="line">        if os.path.exists(filename):</span><br><span class="line">            mode = input(&quot;按ID查找请输入1，按姓名查找请输入2&quot;)</span><br><span class="line">            if mode ==&#x27;1&#x27;:</span><br><span class="line">                id = input(&quot;请输入学生ID&quot;)</span><br><span class="line">            elif mode ==&#x27;2&#x27;:</span><br><span class="line">                name = input(&quot;请输入学生姓名&quot;)</span><br><span class="line">            else:</span><br><span class="line">                print(&quot;您的输入有误，请重新输入&quot;)</span><br><span class="line">                search()</span><br><span class="line">            with open(filename,&#x27;r&#x27;,encoding=&#x27;utf-8&#x27;) as rfile:</span><br><span class="line">                student = rfile.readlines()</span><br><span class="line">                for item in student:</span><br><span class="line">                    d = dict(eval(item))</span><br><span class="line">                    if id!=&#x27;&#x27;:</span><br><span class="line">                        if d[&#x27;id&#x27;] == id:</span><br><span class="line">                            student_query.append(d)</span><br><span class="line">                    if name!=&#x27;&#x27;:</span><br><span class="line">                        if d[&#x27;name&#x27;] ==name:</span><br><span class="line">                            student_query.append(d)</span><br><span class="line">            #显示查询结果</span><br><span class="line">            show_student(student_query)</span><br><span class="line">            #清空列表</span><br><span class="line">            student_query.clear()</span><br><span class="line">            answer = input(&quot;是否继续查询y/n\n&quot;)</span><br><span class="line">            if answer==&#x27;y&#x27; or answer==&#x27;Y&#x27;:</span><br><span class="line">                continue</span><br><span class="line">            else:</span><br><span class="line">                break</span><br><span class="line">        else:</span><br><span class="line">            print(&quot;暂未保存学生信息&quot;)</span><br><span class="line">            return</span><br><span class="line"></span><br><span class="line">def show_student(lst):</span><br><span class="line">    if len(lst) ==0:</span><br><span class="line">        print(&quot;没有查询到学生信息，无数据显示！！！&quot;)</span><br><span class="line">        return</span><br><span class="line">    #定义标题显示格式</span><br><span class="line">    format_title = &#x27;&#123;:^6&#125;\t&#123;:^12&#125;\t&#123;:^8&#125;\t&#123;:^10&#125;\t&#123;:^10&#125;\t&#123;:^8&#125;&#x27;</span><br><span class="line">    print(format_title.format(&#x27;ID&#x27;,&#x27;姓名&#x27;,&#x27;英语成绩&#x27;,&#x27;Python成绩&#x27;,&#x27;Java成绩&#x27;,&#x27;总成绩&#x27;))</span><br><span class="line">    #定义内容显示格式</span><br><span class="line">    format_data = &#x27;&#123;:^6&#125;\t&#123;:^12&#125;\t&#123;:^8&#125;\t&#123;:^10&#125;\t&#123;:^10&#125;\t&#123;:^8&#125;&#x27;</span><br><span class="line">    for item in lst:</span><br><span class="line">        print(format_data.format(item.get(&#x27;id&#x27;),</span><br><span class="line">                                item.get(&#x27;name&#x27;),</span><br><span class="line">                                  item.get(&#x27;english&#x27;),</span><br><span class="line">                                  item.get(&#x27;python&#x27;),</span><br><span class="line">                                  item.get(&#x27;java&#x27;),</span><br><span class="line">                                 int(item.get(&#x27;english&#x27;))+int(item.get(&#x27;python&#x27;))+int(item.get(&#x27;java&#x27;))</span><br><span class="line">                                 ))</span><br><span class="line"></span><br><span class="line">def delete():</span><br><span class="line">    while True:</span><br><span class="line">        student_id = input(&quot;请输入要删除的学生的ID：&quot;)</span><br><span class="line">        if student_id !=&#x27;&#x27;:</span><br><span class="line">            if os.path.exists(filename):</span><br><span class="line">                with open(filename,&#x27;r&#x27;,encoding=&#x27;utf-8&#x27;) as file:</span><br><span class="line">                    student_old = file.readlines()#逐行读取，按行生成一个列表</span><br><span class="line">            else:</span><br><span class="line">                student_old =[]</span><br><span class="line">            flag = False#标记是否删除</span><br><span class="line">            if student_old:#判断原有文件内容是否为空，如果有内容就打开并写入东西</span><br><span class="line">                with open(filename,&#x27;w&#x27;,encoding=&#x27;utf-8&#x27;) as wfile:</span><br><span class="line">                    d=&#123;&#125;</span><br><span class="line">                    for item in student_old:</span><br><span class="line">                        d = dict(eval(item))#将字符串转换为字典</span><br><span class="line">                        if d[&#x27;id&#x27;]!=student_id:</span><br><span class="line">                            wfile.write(str(d)+&quot;\n&quot;)</span><br><span class="line">                        else:</span><br><span class="line">                            flag=True#定义这个标志，同时也没有将变量进行写入，即为删除</span><br><span class="line">                    if flag:</span><br><span class="line">                        print(f&quot;id为&#123;student_id&#125;的学生信息已经被删除。&quot;)</span><br><span class="line">                    else:</span><br><span class="line">                        print(f&quot;没有找到ID为&#123;student_id&#125;的学生信息。&quot;)</span><br><span class="line">            else:</span><br><span class="line">                print(&quot;无学生信息。&quot;)</span><br><span class="line">                break</span><br><span class="line">            show()#删完之后要重新显示学生信息</span><br><span class="line">            answer = input(&quot;是否继续删除？y/n\n&quot;)</span><br><span class="line">            if answer==&#x27;y&#x27; or answer == &quot;Y&quot;:</span><br><span class="line">                continue</span><br><span class="line">            else:</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line">def modify():</span><br><span class="line">    show()</span><br><span class="line">    if os.path.exists(filename):</span><br><span class="line">        with open(filename,&#x27;r&#x27;,encoding=&#x27;utf-8&#x27;) as rfile:</span><br><span class="line">            student_old = rfile.readlines()</span><br><span class="line">    else:</span><br><span class="line">        return</span><br><span class="line">    student_id = input(&quot;请输入要修改的学员的ID：&quot;)</span><br><span class="line">    with open(filename,&#x27;w&#x27;,encoding=&#x27;utf-8&#x27;) as wfile:</span><br><span class="line">        for item in student_old:</span><br><span class="line">            d = dict(eval(item))</span><br><span class="line">            if d[&#x27;id&#x27;]==student_id:#找到要修改的相关id</span><br><span class="line">                print(&quot;找到学生信息，可以修改他的相关信息了！&quot;)</span><br><span class="line">                while True:</span><br><span class="line">                    try:</span><br><span class="line">                        d[&#x27;name&#x27;]=input(&quot;请输入姓名：&quot;)</span><br><span class="line">                        d[&#x27;english&#x27;] =input(&quot;请输入英语成绩：&quot;)</span><br><span class="line">                        d[&#x27;python&#x27;] = input(&quot;请输入Python成绩：&quot;)</span><br><span class="line">                        d[&#x27;Java&#x27;] = input(&quot;请输入Java成绩：&quot;)</span><br><span class="line">                    except:</span><br><span class="line">                        print(&quot;您的输入有误，请重新输入！！！&quot;)</span><br><span class="line">                    wfile.write(str(d)+&quot;\n&quot;)</span><br><span class="line">                    print(&quot;修改成功&quot;)</span><br><span class="line"></span><br><span class="line">            else:</span><br><span class="line">                wfile.write(str(d)+&quot;\n&quot;)</span><br><span class="line">        answer = input(&quot;是否继续修改其他学校信息？y/n\n&quot;)</span><br><span class="line">        if answer==&#x27;y&#x27; or answer ==&#x27;Y&#x27;:</span><br><span class="line">            modify()</span><br><span class="line"></span><br><span class="line">def sort():</span><br><span class="line">    if os.path.exists(filename):</span><br><span class="line">        with open(filename, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as rfile:</span><br><span class="line">            student = rfile.readlines()</span><br><span class="line">        student_new = []</span><br><span class="line">        for item in student:</span><br><span class="line">            d = dict(eval(item))</span><br><span class="line">            student_new.append(d)</span><br><span class="line">    else:</span><br><span class="line">        return</span><br><span class="line">    asc_or_desc = input(&quot;请选择(0.升序 1.降序)&quot;)</span><br><span class="line">    if asc_or_desc==&#x27;0&#x27;:</span><br><span class="line">        asc_or_desc_bool = False</span><br><span class="line">        pass</span><br><span class="line">    elif asc_or_desc==&#x27;1&#x27;:</span><br><span class="line">        asc_or_desc_bool = True</span><br><span class="line">        pass</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;您的输入有误，请重新输入！&quot;)</span><br><span class="line">        sort()</span><br><span class="line">    mode = input(&quot;请选择排序方式(1.按英语成绩排序 2.按Python成绩排序 3.按Java程序排序 0.按总成绩排序)&quot;)</span><br><span class="line">    if mode==&#x27;1&#x27;:</span><br><span class="line">        student_new.sort(key=lambda x:x[&#x27;english&#x27;],reverse=asc_or_desc_bool)</span><br><span class="line">    elif mode==&#x27;2&#x27;:</span><br><span class="line">        student_new.sort(key=lambda x:x[&#x27;python&#x27;],reverse=asc_or_desc_bool)</span><br><span class="line">    elif mode==3:</span><br><span class="line">        student_new.sort(key=lambda x:x[&#x27;java&#x27;],reverse=asc_or_desc_bool)</span><br><span class="line">    elif mode==&#x27;0&#x27;:</span><br><span class="line">        student_new.sort(key=lambda x:x[&#x27;english&#x27;]+x[&#x27;python&#x27;]+x[&#x27;java&#x27;],reverse=asc_or_desc_bool)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;你的输入有误，请重新输入&quot;)</span><br><span class="line">        sort()</span><br><span class="line">    show_student(student_new)</span><br><span class="line"></span><br><span class="line">def total():</span><br><span class="line">    if os.path.exists(filename):</span><br><span class="line">        with open(filename,&#x27;r&#x27;,encoding=&#x27;utf-8&#x27;) as rfile:</span><br><span class="line">            students = rfile.readlines()</span><br><span class="line">            if students:</span><br><span class="line">                print(f&quot;一共有&#123;len(students)&#125;名学生&quot;)</span><br><span class="line">            else:</span><br><span class="line">                print(&quot;还没有录入学生信息&quot;)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;暂未存学生相关信息&quot;)</span><br><span class="line">def show():</span><br><span class="line">    student_ls = []</span><br><span class="line">    if os.path.exists(filename):</span><br><span class="line">        with open(filename,&#x27;r&#x27;,encoding=&#x27;utf-8&#x27;) as rfile:</span><br><span class="line">            students = rfile.readlines()</span><br><span class="line">            for item in students:</span><br><span class="line">                student_ls.append(eval(item))</span><br><span class="line">            if student_ls:</span><br><span class="line">                show_student(student_ls)</span><br><span class="line">            else:</span><br><span class="line">                print(&quot;还没有保存学生信息&quot;)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;没有发现相应数据文件&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ ==&#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<ul>
<li>打包成exe需要在终端激活环境后运行 pip install PyIntaller<br>下载好之后再执行 pyinstaller -F D:\Studentsys\stusystem.py  </li>
</ul>
<p>-F后面是完整路径以及文件名<br><a class="link"   target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1wD4y1o7AS?p=135&amp;spm_id_from=pageDriver" >https://www.bilibili.com/video/BV1wD4y1o7AS?p=135&amp;spm_id_from=pageDriver<i class="fas fa-external-link-alt"></i></a><br>娟姐yyds! </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/05/06/python%E9%85%92%E7%B1%BB%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WenGe Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="弦好想断">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/06/python%E9%85%92%E7%B1%BB%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" class="post-title-link" itemprop="url">python酒类数据分析</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-05-06 20:54:54" itemprop="dateCreated datePublished" datetime="2020-05-06T20:54:54+08:00">2020-05-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-03 14:01:58" itemprop="dateModified" datetime="2022-04-03T14:01:58+08:00">2022-04-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.kf1spxcftw0.png"
                     
                ></p>
<h1 id="一、数据概述"><a href="#一、数据概述" class="headerlink" title="一、数据概述"></a>一、数据概述</h1><p>‘id’,’name’,’price’,’sales’,’ad_word’,’buy_act’,’vote_count’,’url’,’date’,’brand’分别为销售数据的商品ID，商品名称，单价，销量，广告词，促销活动，链接，日期，品牌。<br>以及自构属性‘amount’：销售额，‘month’：月份，‘price_level’：价格区间。</p>
<h1 id="二、提出问题"><a href="#二、提出问题" class="headerlink" title="二、提出问题"></a>二、提出问题</h1><p>1、行业大盘近期（2018/2/27）表现？各价位段表现？<br>总体表现，各价位表现，哪个价位的产品最火，各厂家表现？<br>近期各行业的广告词、促销活动怎么样<br>2、行业大盘总体态势怎样？<br>销量与评论数、单价的关系？<br>时间序列下的行业产品走势？<br>3、如何评价泸州老窖品牌？(可从多角度，规模增长趋势、产品结构等)<br>产品规模、增长趋势、友商竞争、行业水平？</p>
<h1 id="三、行业大盘近周期（2018-2-27）表现？各价位段表现？"><a href="#三、行业大盘近周期（2018-2-27）表现？各价位段表现？" class="headerlink" title="三、行业大盘近周期（2018/2/27）表现？各价位段表现？"></a>三、行业大盘近周期（2018/2/27）表现？各价位段表现？</h1><h3 id="行业大盘2018-2-27总体表现"><a href="#行业大盘2018-2-27总体表现" class="headerlink" title="行业大盘2018/2/27总体表现"></a>行业大盘2018/2/27总体表现</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.4jvl2phdo45c.png"
                     
                ></p>
<h6 id="2018-2-27行业的总销售量为5-663030e-05，总评价数为1-255655e-06，总销售额达1-842307e-08。"><a href="#2018-2-27行业的总销售量为5-663030e-05，总评价数为1-255655e-06，总销售额达1-842307e-08。" class="headerlink" title="2018/2/27行业的总销售量为5.663030e+05，总评价数为1.255655e+06，总销售额达1.842307e+08。"></a>2018/2/27行业的总销售量为5.663030e+05，总评价数为1.255655e+06，总销售额达1.842307e+08。</h6><h6 id="平均单价价格为417元，平均销售642份，平均销售额达209115-4元"><a href="#平均单价价格为417元，平均销售642份，平均销售额达209115-4元" class="headerlink" title="平均单价价格为417元，平均销售642份，平均销售额达209115.4元"></a>平均单价价格为417元，平均销售642份，平均销售额达209115.4元</h6><h6 id="单价中位数199，说明少数高价位的酒提高了总体均值"><a href="#单价中位数199，说明少数高价位的酒提高了总体均值" class="headerlink" title="单价中位数199，说明少数高价位的酒提高了总体均值"></a>单价中位数199，说明少数高价位的酒提高了总体均值</h6><h6 id="销量中位数为148，说明少数及销量高的天数提升了平均交易量"><a href="#销量中位数为148，说明少数及销量高的天数提升了平均交易量" class="headerlink" title="销量中位数为148，说明少数及销量高的天数提升了平均交易量"></a>销量中位数为148，说明少数及销量高的天数提升了平均交易量</h6><h6 id="销售额中位数低于总体均值相差巨大，可能存在爆发交易的情况。"><a href="#销售额中位数低于总体均值相差巨大，可能存在爆发交易的情况。" class="headerlink" title="销售额中位数低于总体均值相差巨大，可能存在爆发交易的情况。"></a>销售额中位数低于总体均值相差巨大，可能存在爆发交易的情况。</h6><h6 id="一天中出现的最高交易量是21685份订单，最高交易额是65011630元，最高单价的白酒为6588元，最高评论数为67514条，最低为0条。"><a href="#一天中出现的最高交易量是21685份订单，最高交易额是65011630元，最高单价的白酒为6588元，最高评论数为67514条，最低为0条。" class="headerlink" title="一天中出现的最高交易量是21685份订单，最高交易额是65011630元，最高单价的白酒为6588元，最高评论数为67514条，最低为0条。"></a>一天中出现的最高交易量是21685份订单，最高交易额是65011630元，最高单价的白酒为6588元，最高评论数为67514条，最低为0条。</h6><h3 id="各价位表现"><a href="#各价位表现" class="headerlink" title="各价位表现"></a>各价位表现</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.6dcpqx9r3pts.png"
                     
                ></p>
<p>在行业大盘最近一个周期内，可以看到销量最好和评论数最高的均是是100-200价位的白酒。<br>在价位50以下白酒销量和评论数出现大反差，在销量差距悬殊的情况下，该类白酒的评论数超过200-500价位白酒的评论数，但是销量偏低说明该类白酒在市场中有较高流行度的同时可能也存在较多的槽点。<br>中等价位（100-500）是市场的主要潮流所在，由中价位向低价位过度的产品（50-100）同样能稳住市场，获得较高的销量与人气。<br>3000以上的销量与评论数极低，符合当今社会人们财富资源分配或生活消费水平的差距，高消费人群只占极少数。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.3ltt1wzyecxs.png"
                     
                ></p>
<p>1000-3000价位席卷市场，高单价情况下即时在低销量时也能远超越其他价位销售额。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.2gkvdbfp9w3k.png"
                     
                ></p>
<p>基本呈现单价越高，评论数越少。人们总是低价商品的要求过于执着？</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.52y9ub6wn7gg.png"
                     
                ></p>
<p>由于其1000-3000单价基数大，导致金额最大</p>
<h3 id="各厂家表现"><a href="#各厂家表现" class="headerlink" title="各厂家表现"></a>各厂家表现</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.4sep09ocakcg.png"
                     
                ></p>
<p>最近一周期五粮液销量最高达到10万瓶以上，远领先于其他厂家。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.3nszvh59q70g.png"
                     
                ></p>
<p>五粮液产品市场评论数最高，应该是广告宣传或者产品质量做得好。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.3ar839q1g2io.png"
                     
                ></p>
<p>茅台近期销售总额位于行业最高水平，销售额近7500万。五粮液可能由于产品单价偏低，销售总额位居第三，接近2000万。</p>
<h3 id="最近一个周期广告、促销活动怎么做的？"><a href="#最近一个周期广告、促销活动怎么做的？" class="headerlink" title="最近一个周期广告、促销活动怎么做的？"></a>最近一个周期广告、促销活动怎么做的？</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.6gq0tn4yo9og.png"
                     
                ></p>
<p>广告词一以‘天猫配送’，‘正品保证’等为主要标语，‘东方习酒’，‘猫超自营’，‘地道北京味’也是主要宣传方向。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.5ancn0q8cccg.png"
                     
                ></p>
<p>促销活动主要以‘满一1或2送任意一件赠品，赠完为止’作为主要促销活动。</p>
<h1 id="四、行业大盘总体态势怎样？"><a href="#四、行业大盘总体态势怎样？" class="headerlink" title="四、行业大盘总体态势怎样？"></a>四、行业大盘总体态势怎样？</h1><h3 id="销量与单价、评论数的关系"><a href="#销量与单价、评论数的关系" class="headerlink" title="销量与单价、评论数的关系"></a>销量与单价、评论数的关系</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.3mw3xybva7nk.png"
                     
                ></p>
<p>评论数量变化与销量基本呈线性变化。评论数代表市场反应，市场热度越高，销量越高。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.4o6xp1btc9g.png"
                     
                ></p>
<p>单价与销量基本成反比例变化。单价越高，销量越低，单价越低，销量越高。<br>###时间序列下的行业产品走势<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.3dp2nbjq0t34.png"
                     
                ></p>
<p>200-500价位段的商品销量呈上升趋势，0-50和50-100的商品在2017年11月上升后出现持续下降，100-200的商品在上升后保持平稳，基本站稳市场。500-3000区间内商品在同年12月后出现小范围增长，因其单价基数较大，可能引起销售额大幅增长。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.5ucvrzq2vfcw.png"
                     
                ></p>
<p>除0-50和3000以上产品外，其他商品都在2017年11月后出现销售额显著增长，推测可能是双十一以及其他促销活动，但是对0-50和3000以上的商品销售状态基本无影响。1000-3000区间商品在2017年12月过后出现直线式增长，100-500区间产品作为市场主力也出现增长趋势。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.4ucsu4issccg.png"
                     
                ></p>
<p>3000月以上的酒类在11月出现价格大额下跌，其他区间商品单价均走势平稳。</p>
<h1 id="五、泸州老窖自身增长的趋势，产品结构，行业水平"><a href="#五、泸州老窖自身增长的趋势，产品结构，行业水平" class="headerlink" title="五、泸州老窖自身增长的趋势，产品结构，行业水平"></a>五、泸州老窖自身增长的趋势，产品结构，行业水平</h1><h3 id="泸州老窖产品规模"><a href="#泸州老窖产品规模" class="headerlink" title="泸州老窖产品规模"></a>泸州老窖产品规模</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.t3dlkrd7ojk.png"
                     
                ></p>
<p>泸州老窖品牌主打50-500价位产品覆盖市场，其中3000+超高价酒类占比与0-50低价品类占比最低，均低于500-3000档位，说明泸州老窖在市场的品牌形象与战略目标是做好中高端酒类产品。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.2jviql0m0lc0.png"
                     
                ></p>
<p>在2017年12月产品规模突然增大，应该是与行业竞争或市场需求相关。 </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.nkodwqpgads.png"
                     
                ></p>
<p>销量在十一月份出现大幅增长，持续到次年一月份出现显著下降。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.hxptteb9rh.png"
                     
                ></p>
<p>总销售额与销量表现相似，也是在十一月份出现大幅增长，持续到次年一月份出现显著下降。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.5cjonwptotq8.png"
                     
                ></p>
<p>0-50区间产品在十一月后大幅增长，后持续衰弱。50-500区间商品同期均出现显著增长，后缓慢下降趋于稳定。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.2n30ocmjuzr4.png"
                     
                ></p>
<p>200-500与1000-3000区间商品由于其单价基数较大，在同年十一月销量保证的前提下，出现大幅增长。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.4843aw978akg.png"
                     
                ></p>
<p>3000+产品在2017年7月-9月出现波动后趋于平稳。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.3g6dp00zw7cw.png"
                     
                ></p>
<p>17年9月可能出现了一些问题，除500-1000区间外，都出现了先增后降的趋势。</p>
<h3 id="那种广告词、促销标语出现的最多"><a href="#那种广告词、促销标语出现的最多" class="headerlink" title="那种广告词、促销标语出现的最多"></a>那种广告词、促销标语出现的最多</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.79nh5qchwhds.png"
                     
                ></p>
<p>该品牌主打广告关键词： ‘’限时直降‘’，‘甄选好货’，‘厂家直供’。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.6vpepnq4p2m8.png"
                     
                ></p>
<p>主打的促销标语为 ‘’送任意一件赠品，赠完即止‘’。</p>
<h3 id="选择牛栏山作为泸州老窖竞争对手"><a href="#选择牛栏山作为泸州老窖竞争对手" class="headerlink" title="选择牛栏山作为泸州老窖竞争对手"></a>选择牛栏山作为泸州老窖竞争对手</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.7k75jdss8f0g.png"
                     
                ></p>
<p>牛栏山品牌在产品布局上和泸州老窖都是主打50-500价位段商品布局，但是牛栏山在0-50上的产品数多于500-1000价位的产品数量。且没有3000元以上产品上市，可见牛栏山品牌试图留住中端价位产品客户，拉拢低价位产品客户的战略方针。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.585gbomsxjsw.png"
                     
                ></p>
<p>与泸州老窖相似均在十二月出现了较大幅度的增长。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.5tcjs54m9rwg.png"
                     
                ></p>
<p>泸州老窖只在200-300和超1000元以上的产品销量小范围领先友商，但由于单价基数较大，可能会有意想不到的效果哦</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.696y93qi0eps.png"
                     
                ></p>
<p>泸州老窖销售额仅在200-500和1000元以上三个价位段领先友商，在50-200价位，销售额较大程度低于友商。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.65kolxn2i16o.png"
                     
                ></p>
<p>除了200-500和1000以上价位的产品，泸州老窖品牌产品收到的市场评论与反馈均低于友商，可见友商的宣传力度或产品口碑在市场中占有较高热度 。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.1ebr4yfjo2n4.png"
                     
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.6uo6tbp5jfk0.png"
                     
                ></p>
<p>可以看到两个品牌的销售额主要来源产品类别有明显差异。</p>
<h3 id="泸州老窖在行业的水平如何"><a href="#泸州老窖在行业的水平如何" class="headerlink" title="泸州老窖在行业的水平如何"></a>泸州老窖在行业的水平如何</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.23phzpw6q96o.png"
                     
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.535us8b7xog0.png"
                     
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.6n2czq2ijcow.png"
                     
                ><br>泸州老窖位于行业的上游水平，产品规模完善，各价位商品数量布局体现了明确的行业目标：要做中高端酒类产品的佼佼者。且不放弃低价位的0-50系列产品，全面覆盖市场，在给定的时间数据中，各区间段产品除0-50与3000+以外，其他商品的销量与销售额均呈持续缓慢上升趋势。可以看到该企业处于一个蓬勃向上，逐步冲向高端的行业发展状态。</p>
<h1 id="六、分析结论"><a href="#六、分析结论" class="headerlink" title="六、分析结论"></a>六、分析结论</h1><p>1、近期行业呈现蓬勃向上的发展状态，0-50价位产品的销量与评论数出现较大市场反差，100-200价位段的商品销量最火，位于市场销量及销售额榜首的是茅台品牌，五粮液以市场获评数最高位居榜首。行业广告词以‘天猫配送’，‘正品保证’等作为主要标语，以‘满1或2件送任意一件赠品，赠完为止’作为主要促销活动。<br>2、行业总体发展十分成熟，各品牌产品竞争力都十分明显，销量与评论基本呈正相关线性关系，与单价成反比例关系，100-500区间产品销量作为市场主流，1000元以上产品可能在销售额上反超其他高销量产品，双十一对市场的刺激反响极为强烈。<br>3、泸州老窖主打中高端酒类产品，全价位品类布局全面，综合实力处于全行业上游水平。销量受双十一影响显著，导致200-500与1000-3000区间商品销售额大幅增长。该品牌主打广告关键词： ‘’限时直降‘’，‘甄选好货’，‘厂家直供’。主要促销活动为 ‘’送任意一件赠品，赠完即止‘’。其总体销售额主要来源于100-3000价位产品，相比牛栏山不相上下，在中高价位品类优势明显，0-100价位段还有较大进步空间。</p>
<h1 id="七、python代码"><a href="#七、python代码" class="headerlink" title="七、python代码"></a>七、python代码</h1><h3 id="导入包，设定字体和画图风格"><a href="#导入包，设定字体和画图风格" class="headerlink" title="导入包，设定字体和画图风格"></a>导入包，设定字体和画图风格</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">import numpy as np</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">%matplotlib inline</span><br><span class="line">import seaborn as sns</span><br><span class="line">from wordcloud import WordCloud</span><br><span class="line">plt.rcParams[&#x27;font.sans-serif&#x27;] = [&#x27;SimHei&#x27;]#显示中文</span><br><span class="line">plt.style.use(&#x27;ggplot&#x27;)</span><br></pre></td></tr></table></figure>
<h3 id="导入并清洗数据"><a href="#导入并清洗数据" class="headerlink" title="导入并清洗数据"></a>导入并清洗数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#导入数据</span><br><span class="line">path = &#x27;D:/python_data_file/Alcohol.xlsx&#x27;</span><br><span class="line">def load_alcohol_data(path):</span><br><span class="line">    df = pd.read_excel(path)</span><br><span class="line">    df.columns = [&#x27;id&#x27;,&#x27;name&#x27;,&#x27;price&#x27;,&#x27;sales&#x27;,&#x27;ad_word&#x27;,&#x27;buy_act&#x27;,&#x27;vote_count&#x27;,&#x27;url&#x27;,&#x27;date&#x27;,&#x27;brand&#x27;]</span><br><span class="line">    df = df[df.price.notnull()]</span><br><span class="line">    df[&#x27;amount&#x27;] = df[&#x27;sales&#x27;]*df[&#x27;price&#x27;]</span><br><span class="line">    df[&#x27;month&#x27;] = df.date.values.astype(&#x27;datetime64[M]&#x27;)#日期时间序列转化为月份时间序列</span><br><span class="line">    return df</span><br><span class="line">df = load_alcohol_data(path)</span><br><span class="line">#对酒类单价分层</span><br><span class="line">def price_level(data):</span><br><span class="line">    a=[]</span><br><span class="line">    for i in data.price:</span><br><span class="line">        if i &lt;50:</span><br><span class="line">            a.append(&#x27;0-50&#x27;)</span><br><span class="line">        elif i &lt;100:</span><br><span class="line">            a.append(&#x27;50-100&#x27;)</span><br><span class="line">        elif i &lt;200:</span><br><span class="line">            a.append(&#x27;100-200&#x27;)</span><br><span class="line">        elif i&lt;500:</span><br><span class="line">            a.append(&#x27;200-500&#x27;)</span><br><span class="line">        elif i &lt;1000:</span><br><span class="line">            a.append(&#x27;500-1000&#x27;)</span><br><span class="line">        elif i&lt;3000:</span><br><span class="line">            a.append(&#x27;1000-3000&#x27;)</span><br><span class="line">        else:</span><br><span class="line">            a.append(&#x27;3000+&#x27;)</span><br><span class="line">    data[&#x27;price_level&#x27;] = a</span><br><span class="line">    data = data.reset_index(drop=True)</span><br><span class="line">    return data</span><br><span class="line">df = price_level(df)</span><br><span class="line">recent_df = df[df.date==&#x27;2018-02-27&#x27;]</span><br><span class="line">recent_df[[&#x27;sales&#x27;,&#x27;vote_count&#x27;,&#x27;amount&#x27;]].sum()</span><br><span class="line">recent_df.describe()</span><br><span class="line">lzlj_df = df[df.brand==&#x27;泸州老窖&#x27;].reset_index(drop=True)</span><br><span class="line">lzlj_df = price_level(lzlj_df)</span><br><span class="line">lzlj_df.describe()</span><br></pre></td></tr></table></figure>
<h3 id="近期各厂家的表现"><a href="#近期各厂家的表现" class="headerlink" title="近期各厂家的表现"></a>近期各厂家的表现</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#各厂家的表现就在这了</span><br><span class="line">all_brand = recent_df.groupby(&#x27;brand&#x27;)[[&#x27;sales&#x27;,&#x27;vote_count&#x27;,&#x27;amount&#x27;]].sum().sort_values(by=</span><br><span class="line">&#x27;amount&#x27;,ascending = True).reset_index()</span><br><span class="line">all_brand.sales.plot.bar()</span><br><span class="line">plt.title(&#x27;各厂家销量对比&#x27;)</span><br><span class="line">all_brand.vote_count.plot.bar()</span><br><span class="line">plt.title(&#x27;各厂家评论数&#x27;)</span><br><span class="line">all_brand.amount.plot.bar()</span><br><span class="line">plt.title(&#x27;各厂家销售额&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="画柱状图"><a href="#画柱状图" class="headerlink" title="画柱状图"></a>画柱状图</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#x写个画图函数，不然太麻烦了</span><br><span class="line">def pic_barh(data,tit,xbel,ybel):</span><br><span class="line">    data.sort_values().plot.barh(figsize=(12,6))</span><br><span class="line">    plt.title(tit,fontsize = 20)</span><br><span class="line">    plt.xlabel(xbel,fontsize = 20)</span><br><span class="line">    plt.ylabel(ybel,fontsize = 20)</span><br><span class="line">    plt.show()</span><br><span class="line">pic_barh(level_performance_mean.price,&#x27;近期平均价格表现&#x27;,&#x27;价格&#x27;,&#x27;区间&#x27;)</span><br><span class="line">pic_barh(level_performance_sum.amount,&#x27;近期销售额表现&#x27;,&#x27;金额&#x27;,&#x27;区间&#x27;)</span><br><span class="line">pic_barh(level_performance_mean.vote_count,&#x27;近期评论表现&#x27;,&#x27;评论数&#x27;,&#x27;区间&#x27;)</span><br><span class="line">pic_barh(level_performance_mean.amount,&#x27;近期平均金额表现&#x27;,&#x27;金额&#x27;,&#x27;区间&#x27;)</span><br></pre></td></tr></table></figure>
<h3 id="近期各价位段表现"><a href="#近期各价位段表现" class="headerlink" title="近期各价位段表现"></a>近期各价位段表现</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">level_performance_sum = recent_df.groupby(&#x27;price_level&#x27;)[</span><br><span class="line">&#x27;sales&#x27;,&#x27;vote_count&#x27;,&#x27;amount&#x27;].sum().sort_values(by=&#x27;sales&#x27;,ascending=False)</span><br><span class="line">level_performance_mean = recent_df.groupby(&#x27;price_level&#x27;)[</span><br><span class="line">&#x27;price&#x27;,&#x27;sales&#x27;,&#x27;vote_count&#x27;,&#x27;amount&#x27;].mean().sort_values(by=&#x27;sales&#x27;,ascending=False)</span><br><span class="line">#绘制利润与评论数柱状图</span><br><span class="line">level_performance_sum.loc[:,[&#x27;sales&#x27;,&#x27;vote_count&#x27;]].plot.bar(figsize=(12,6))</span><br></pre></td></tr></table></figure>
<h3 id="寻找竞争品牌"><a href="#寻找竞争品牌" class="headerlink" title="寻找竞争品牌"></a>寻找竞争品牌</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#想写个函数找出泸州老窖的上下各相邻两个的品牌，也就是它的竞争品牌</span><br><span class="line">def lookup_name(data):</span><br><span class="line">    for i in range(len(data)):</span><br><span class="line">        if data.loc[i,&#x27;brand&#x27;] ==&#x27;泸州老窖&#x27;:</span><br><span class="line">            return [data.loc[i-1,&#x27;brand&#x27;],data.loc[i-2,&#x27;brand&#x27;],data.loc[i+1,&#x27;brand&#x27;],data.loc[i+2,&#x27;brand&#x27;]]</span><br><span class="line">        else:</span><br><span class="line">            continue</span><br><span class="line">#按品牌分组求均值，再分别按价格、销量和金额排序，然后找出竞争品牌</span><br><span class="line">df_brand_price_mean = df.groupby(&#x27;brand&#x27;,as_index=False)[[</span><br><span class="line">    &#x27;price&#x27;,&#x27;sales&#x27;,&#x27;amount&#x27;]].mean().sort_values(by=&#x27;price&#x27;,ascending=True).reset_index(drop=True)</span><br><span class="line">lookup_name(df_brand_price_mean)#[&#x27;汾酒&#x27;, &#x27;珍酒&#x27;, &#x27;剑南春&#x27;, &#x27;白云边&#x27;]</span><br><span class="line">df_brand_sales_mean=df.groupby(&#x27;brand&#x27;,as_index=False)[[</span><br><span class="line">    &#x27;price&#x27;,&#x27;sales&#x27;,&#x27;amount&#x27;]].mean().sort_values(by=&#x27;sales&#x27;,ascending=True).reset_index(drop=True)</span><br><span class="line">df_brand_amount_mean= df.groupby(&#x27;brand&#x27;,as_index=False)[[</span><br><span class="line">    &#x27;price&#x27;,&#x27;sales&#x27;,&#x27;amount&#x27;]].mean().sort_values(by=&#x27;amount&#x27;,ascending=True).reset_index(drop=True)</span><br><span class="line">#按品牌分组求和，再分别按价格、销量和金额排序，然后找出竞争品牌</span><br><span class="line">df_brand_amount_sum=df.groupby(&#x27;brand&#x27;,as_index=False)[[</span><br><span class="line">    &#x27;sales&#x27;,&#x27;amount&#x27;]].sum().sort_values(by=&#x27;amount&#x27;,ascending = True).reset_index(drop=True)</span><br><span class="line">df_brand_sales_sum=df.groupby(&#x27;brand&#x27;,as_index=False)[[</span><br><span class="line">    &#x27;sales&#x27;,&#x27;amount&#x27;]].sum().sort_values(by=&#x27;sales&#x27;,ascending = True).reset_index(drop=True)</span><br><span class="line">a_sums = set(lookup_name(df_brand_amount_sum)+lookup_name(df_brand_sales_sum))</span><br><span class="line">a_means = set(lookup_name(df_brand_price_mean)+lookup_name(df_brand_sales_mean)+lookup_name(df_brand_amount_mean))</span><br><span class="line">s = set(list(a_means)+list(a_sums))</span><br><span class="line">#&#123;&#x27;习酒&#x27;,&#x27;五粮液&#x27;,&#x27;剑南春&#x27;,&#x27;劲酒&#x27;,&#x27;古井贡酒&#x27;, &#x27;水井坊&#x27;, &#x27;江小白&#x27;, &#x27;汾酒&#x27;, &#x27;洋河&#x27;, &#x27;牛栏山&#x27;,&#x27;珍酒&#x27;,</span><br><span class="line"># &#x27;白云边&#x27;,&#x27;红星&#x27;,&#x27;茅台&#x27;&#125; 选取剑南春 古井贡酒 牛栏山 五粮液作为泸州老窖的竞争对手</span><br></pre></td></tr></table></figure>
<h3 id="生成词云图"><a href="#生成词云图" class="headerlink" title="生成词云图"></a>生成词云图</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#提取广告词字符串</span><br><span class="line">def ad_words_str(data):</span><br><span class="line">    ad_words_list = []</span><br><span class="line">    for x in data.ad_word.dropna():</span><br><span class="line">        ad_words_list.append(x)</span><br><span class="line">    ad_words_list = &#x27;&#x27;.join(ad_words_list)</span><br><span class="line">    return ad_words_list</span><br><span class="line">#提取促销活动字符串</span><br><span class="line">def buy_act_str(data):</span><br><span class="line">    buy_act_list=[]</span><br><span class="line">    for x in data.buy_act.dropna():</span><br><span class="line">        buy_act_list.append(x)</span><br><span class="line">    buy_act_list = &#x27;&#x27;.join(buy_act_list)</span><br><span class="line">    return buy_act_list</span><br><span class="line">#生成词云</span><br><span class="line">def pic_words(keywords_list):</span><br><span class="line">    keywords_list.replace(&#x27;\s&#x27;,&#x27;&#x27;)#去除字符串中空字符串（\s用于匹配空白字符，可能是空格、制表符、其他空白））</span><br><span class="line">    font = &#x27;C:\Windows\Fonts\msyh.ttc&#x27;</span><br><span class="line">    wordcloud = WordCloud(background_color=&#x27;white&#x27;,max_words=3000,scale=1.5,font_path=font).generate(keywords_list)</span><br><span class="line">    plt.figure(figsize=(14,8))</span><br><span class="line">    plt.imshow(wordcloud)</span><br><span class="line">    plt.axis(&#x27;off&#x27;)</span><br><span class="line">    plt.show()</span><br><span class="line">listb = ad_words_str(lzlj_df)+buy_act_str(lzlj_df)</span><br><span class="line">#行业大盘最近一个周期的词云</span><br><span class="line">pic_words(ad_words_str(recent_df))</span><br><span class="line">pic_words(buy_act_str(recent_df))</span><br><span class="line">pic_words(ad_words_str(lzlj_df))</span><br><span class="line">pic_words(buy_act_str(lzlj_df))</span><br></pre></td></tr></table></figure>
<h1 id="画走势图"><a href="#画走势图" class="headerlink" title="画走势图"></a>画走势图</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">df.plot.scatter(x=&#x27;price&#x27;,y=&#x27;sales&#x27;)</span><br><span class="line">plt.title(&#x27;销量与单价&#x27;)</span><br><span class="line">df.plot.scatter(x=&#x27;vote_count&#x27;,y=&#x27;sales&#x27;)</span><br><span class="line">plt.title(&#x27;销量与评论数&#x27;)</span><br><span class="line">#写个画图函数，它不香吗</span><br><span class="line">def pic_trend(data,val,agg,tit,ylab):</span><br><span class="line">    a_sum = data.pivot_table(</span><br><span class="line">        index=&#x27;price_level&#x27;,columns=&#x27;month&#x27;,values=val,aggfunc=agg).fillna(0).T</span><br><span class="line">    plt.figure(figsize=(12,6))</span><br><span class="line">    a_sum.plot()</span><br><span class="line">    plt.title(tit,fontsize=20)</span><br><span class="line">    plt.ylabel(ylab,fontsize=15)</span><br><span class="line">    plt.show()</span><br><span class="line">pic_trend(lzlj_df,&#x27;sales&#x27;,&#x27;sum&#x27;,&#x27;泸州老窖各区间产品销量走势&#x27;,&#x27;sales&#x27;)</span><br><span class="line">pic_trend(lzlj_df,&#x27;amount&#x27;,&#x27;sum&#x27;,&#x27;泸州老窖销售额走势&#x27;,&#x27;amount&#x27;)</span><br><span class="line">pic_trend(lzlj_df,&#x27;price&#x27;,&#x27;mean&#x27;,&#x27;泸州老窖产品单价走势&#x27;,&#x27;price&#x27;)</span><br><span class="line">pic_trend(lzlj_df,&#x27;vote_count&#x27;,&#x27;sum&#x27;,&#x27;泸州老窖产品评论走势&#x27;,&#x27;vote_count&#x27;)</span><br><span class="line">pic_trend(df,&#x27;sales&#x27;,&#x27;sum&#x27;,&#x27;总体各区间产品销量走势&#x27;,&#x27;sales&#x27;)</span><br><span class="line">pic_trend(df,&#x27;amount&#x27;,&#x27;sum&#x27;,&#x27;总体产品销售额走势&#x27;,&#x27;amount&#x27;)</span><br><span class="line">pic_trend(df,&#x27;price&#x27;,&#x27;mean&#x27;,&#x27;总体产品单价走势&#x27;,&#x27;price&#x27;)</span><br><span class="line">pic_trend(df,&#x27;vote_count&#x27;,&#x27;sum&#x27;,&#x27;总体产品评论走势&#x27;,&#x27;vote_count&#x27;)</span><br></pre></td></tr></table></figure>
<h1 id="得到各品牌数据"><a href="#得到各品牌数据" class="headerlink" title="得到各品牌数据"></a>得到各品牌数据</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#写个函数用来对各品牌数据拆分</span><br><span class="line">def df_brand(data,brand):</span><br><span class="line">    data = data[data.brand==brand].reset_index(drop=True)</span><br><span class="line">    data = price_level(data)</span><br><span class="line">    data[&#x27;amount&#x27;] = data[&#x27;sales&#x27;]*data[&#x27;price&#x27;]</span><br><span class="line">    return data</span><br><span class="line"># list_brand = [&#x27;剑南春&#x27;,&#x27;古井贡酒&#x27;,&#x27;牛栏山&#x27;,&#x27;五粮液&#x27;,&#x27;泸州老窖&#x27;]</span><br><span class="line"># for i in list_brand:</span><br><span class="line">#     df_brand(df,i)</span><br><span class="line">#对该品牌的各价位段进行分组求和</span><br><span class="line">def df_brand_groupby_sum(data):</span><br><span class="line">    data = data.groupby(&#x27;price_level&#x27;).sum().loc[:,[&#x27;sales&#x27;,&#x27;vote_count&#x27;,&#x27;amount&#x27;]]</span><br><span class="line">    return data</span><br><span class="line"></span><br><span class="line"># 剑南春 古井贡酒 牛栏山 五粮液 #各个价格段的销量、评论量、销售额汇总</span><br><span class="line">lzlj_sum = df_brand_groupby_sum(df_brand(df,&#x27;泸州老窖&#x27;))</span><br><span class="line">jlc_sum = df_brand_groupby_sum(df_brand(df,&#x27;剑南春&#x27;))</span><br><span class="line">gjgj_sum = df_brand_groupby_sum(df_brand(df,&#x27;古井贡酒&#x27;))</span><br><span class="line">nls_sum = df_brand_groupby_sum(df_brand(df,&#x27;牛栏山&#x27;))</span><br><span class="line">wly_sum = df_brand_groupby_sum(df_brand(df,&#x27;五粮液&#x27;))</span><br></pre></td></tr></table></figure>
<h3 id="画饼图"><a href="#画饼图" class="headerlink" title="画饼图"></a>画饼图</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">def pic_pie(data,gby,tit):</span><br><span class="line">    price_count = data.groupby(gby).count().reset_index(drop=False)</span><br><span class="line">    fig = plt.figure(figsize=(16,8))</span><br><span class="line">    plt.pie(price_count.price,labels=price_count[gby],autopct=&#x27;%.1f%%&#x27;)</span><br><span class="line">    plt.title(tit,fontsize = 15)</span><br><span class="line">pic_pie(nls_df,&#x27;price_level&#x27;,&#x27;牛栏山产品价位规模&#x27;)</span><br><span class="line">pic_pie(nls_df,&#x27;month&#x27;,&#x27;牛栏山产品月份规模&#x27;)</span><br><span class="line">pic_pie(lzlj_df,&#x27;price_level&#x27;,&#x27;泸州老窖产品价位规模&#x27;)</span><br><span class="line">pic_pie(lzlj_df,&#x27;month&#x27;,&#x27;泸州老窖产品月份规模&#x27;)</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=(16,8))</span><br><span class="line">plt.pie(lzlj_sum.sales,labels=lzlj_sum.index,autopct=&#x27;%.1f%%&#x27;)</span><br><span class="line">plt.title(&#x27;泸州老窖各价位销量图&#x27;,fontsize = 15)</span><br><span class="line">fig = plt.figure(figsize=(16,8))</span><br><span class="line">plt.pie(nls_sum.vote_count,labels=nls_sum.index,autopct=&#x27;%.1f%%&#x27;)</span><br><span class="line">plt.title(&#x27;牛栏山各价位评论数图&#x27;,fontsize = 15)</span><br><span class="line"></span><br><span class="line">#按月份销量变化</span><br><span class="line">lzlj_df.groupby(&#x27;month&#x27;).sales.sum().plot()</span><br><span class="line">plt.title(&#x27;销量按月份变化&#x27;)</span><br><span class="line">#总销售额随时间变化</span><br><span class="line">lzlj_df.groupby(&#x27;month&#x27;).amount.sum().plot()</span><br><span class="line">plt.title(&#x27;总销售额随时间变化&#x27;)</span><br><span class="line"></span><br><span class="line">def pic_bar2(arg):</span><br><span class="line">    sales_dif = nls_sum.sales.reset_index().merge(lzlj_sum[arg].reset_index(),on=&#x27;price_level&#x27;,how=&#x27;outer&#x27;,suffixes=[&#x27;_nls&#x27;,&#x27;_lzlj&#x27;])</span><br><span class="line">    sales_dif = sales_dif.set_index(&#x27;price_level&#x27;)</span><br><span class="line">    plt.figure(figsize=(12,10))</span><br><span class="line">    sales_dif.plot.bar()</span><br><span class="line">    plt.title(&#x27;泸州老窖与牛栏山&#x27;+str(arg)+&#x27;对比&#x27;)</span><br><span class="line">pic_bar2(&#x27;sales&#x27;)</span><br><span class="line">pic_bar2(&#x27;amount&#x27;)</span><br><span class="line">pic_bar2(&#x27;vote_count&#x27;)</span><br><span class="line"></span><br><span class="line">pic_barh(df_brand_sum.sales,&#x27;各品牌销售总量对比&#x27;,&#x27;销量&#x27;,&#x27;品牌&#x27;)</span><br><span class="line">pic_barh(df_brand_sum.amount,&#x27;各品牌销售总金额对比&#x27;,&#x27;金额&#x27;,&#x27;品牌&#x27;)</span><br><span class="line">pic_barh(df_brand_sum.vote_count,&#x27;各品牌产品评论数对比&#x27;,&#x27;评论数&#x27;,&#x27;品牌&#x27;)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/04/20/sql%E4%BA%92%E8%81%94%E7%BD%91%E6%B8%B8%E6%88%8F%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WenGe Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="弦好想断">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/20/sql%E4%BA%92%E8%81%94%E7%BD%91%E6%B8%B8%E6%88%8F%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" class="post-title-link" itemprop="url">sql互联网游戏数据分析</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-04-20 01:45:16" itemprop="dateCreated datePublished" datetime="2020-04-20T01:45:16+08:00">2020-04-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-03 14:10:24" itemprop="dateModified" datetime="2022-04-03T14:10:24+08:00">2022-04-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、数据概览"><a href="#一、数据概览" class="headerlink" title="一、数据概览"></a>一、数据概览</h1><p>数据共有828934条，108列标签</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.14j5jvjer19c.png"
                     
                ></p>
<p>本文主要对以下10个字段进行分析</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.15fg7qqjowkg.png"
                     
                ></p>
<p>使用工具：Navicat Premium ，jupyter notebook<br>技能要求：SQL掌握到子查询，Python连接数据库（不连也可以）</p>
<h1 id="二、提出问题："><a href="#二、提出问题：" class="headerlink" title="二、提出问题："></a>二、提出问题：</h1><p>1、新增玩家分析：从玩家数量、玩家占比、每日新增玩家数展开分析<br>2、玩家活跃度分析：从不同用户在线时长、分布特征展开分析<br>3、玩家付费情况分析：从PUR（付费比率）、ARPPU（活跃付费用户平均消费金额）等关键指标展开分析<br>4、玩家游戏习惯分析：从不同玩家类型、游戏模式（PVP与PVE）得出的情况来展开分析</p>
<h1 id="三、新增玩家分析"><a href="#三、新增玩家分析" class="headerlink" title="三、新增玩家分析"></a>三、新增玩家分析</h1><p>新增玩家数量：828934人</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT count(DISTINCT user_id) 新增玩家数量 FROM `tap_fun_test`</span><br></pre></td></tr></table></figure>
<p>新增付费玩家数量：19549</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(DISTINCT(user_id))  新增付费玩家数量 from tap_fun_test where pay_price &gt;0;</span><br></pre></td></tr></table></figure>
<p>付费玩家占比:0.0236</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select 新增付费玩家/新增玩家数 as 付费玩家占比 from </span><br><span class="line">(SELECT count(distinct user_id) 新增玩家数 from tap_fun_test) as t1 ,</span><br><span class="line">(SELECT count(DISTINCT user_id)  新增付费玩家 from tap_fun_test where pay_price&gt;0) as t2 ;</span><br></pre></td></tr></table></figure>
<p>每日新增用户数量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select date(register_time) 日期,count(DISTINCT(user_id)) from tap_fun_test GROUP BY 日期;</span><br></pre></td></tr></table></figure>

<p>每日新增付费用户数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select date(register_time) 日期,count(DISTINCT(user_id)) from tap_fun_test where pay_price&gt;0 GROUP BY 日期;</span><br></pre></td></tr></table></figure>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.1w7wlbjdniow.png"
                     
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.4v3ad1gpu2v4.png"
                     
                ></p>
<p>每日新增玩家在3月10日有一次大高峰增长，可能举办活动，但活动一过后续新增玩家数并没有显著提升，可见活动没有游戏的人气带来实质性的帮助。<br>活动需要力度加强并保持一定时间维度，给玩家充分时间了解游戏，才能提高秀逸热度。</p>
<p>全部玩家平均在线时长:11.741103057664969</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT avg(avg_online_minutes)  as 全部玩家平均在线时长 from tap_fun_test;</span><br></pre></td></tr></table></figure>
<p>付费玩家平均在线时长:135.8732415946089</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select avg(avg_online_minutes) from tap_fun_test where pay_price&gt;0;</span><br></pre></td></tr></table></figure>
<h1 id="四、玩家活跃度分析"><a href="#四、玩家活跃度分析" class="headerlink" title="四、玩家活跃度分析"></a>四、玩家活跃度分析</h1><p>平均在线时长的分布特点<br>###全部玩家人数的中位数、上下四分位数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select round(count(distinct user_id)/4) as 下四分位数,</span><br><span class="line">round(count(distinct user_id)/2) as 中位数,</span><br><span class="line">round(count(distinct user_id)/4*3) as 上四分位数</span><br><span class="line">from tap_fun_test;</span><br></pre></td></tr></table></figure>
<h4 id="下四分位数：207234-中位数：414467-上四分位数：621701"><a href="#下四分位数：207234-中位数：414467-上四分位数：621701" class="headerlink" title="下四分位数：207234    中位数：414467    上四分位数：621701"></a>下四分位数：207234    中位数：414467    上四分位数：621701</h4><h3 id="全部玩家在线时长箱线图关键值"><a href="#全部玩家在线时长箱线图关键值" class="headerlink" title="全部玩家在线时长箱线图关键值"></a>全部玩家在线时长箱线图关键值</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT min(avg_online_minutes) 最小值,</span><br><span class="line">(select avg_online_minutes from tap_fun_test ORDER BY avg_online_minutes LIMIT 207233,1) as 下四分位数,</span><br><span class="line">(select avg_online_minutes from tap_fun_test ORDER BY avg_online_minutes LIMIT 414466,1) as 中位数,</span><br><span class="line">(select avg_online_minutes from tap_fun_test ORDER BY avg_online_minutes LIMIT 621700,1) as 上四分位数,</span><br><span class="line">max( avg_online_minutes) 最大值</span><br><span class="line">FROM `tap_fun_test`	</span><br></pre></td></tr></table></figure>
<h4 id="最小值0-0-下四分位数-0-5-中位数-1-666667，上四分位数：5，最大值：1605-833333"><a href="#最小值0-0-下四分位数-0-5-中位数-1-666667，上四分位数：5，最大值：1605-833333" class="headerlink" title="最小值0.0,下四分位数:0.5,中位数:1.666667，上四分位数：5，最大值：1605.833333"></a>最小值0.0,下四分位数:0.5,中位数:1.666667，上四分位数：5，最大值：1605.833333</h4><h3 id="付费玩家的人数最大值最小值、中位数、上下四分位数"><a href="#付费玩家的人数最大值最小值、中位数、上下四分位数" class="headerlink" title="付费玩家的人数最大值最小值、中位数、上下四分位数"></a>付费玩家的人数最大值最小值、中位数、上下四分位数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select round(count(distinct user_id)/4) as 下四分位数,</span><br><span class="line">round(count(distinct user_id)/2) as 中位数,</span><br><span class="line">round(count(distinct user_id)/4*3) as 上四分位数</span><br><span class="line">from tap_fun_test </span><br><span class="line">WHERE pay_price&gt;0;</span><br></pre></td></tr></table></figure>
<h4 id="下四分位数：4887，-中位数：9775-上四分位数：14662"><a href="#下四分位数：4887，-中位数：9775-上四分位数：14662" class="headerlink" title="下四分位数：4887，    中位数：9775    上四分位数：14662"></a>下四分位数：4887，    中位数：9775    上四分位数：14662</h4><h1 id="付费玩家在线时长箱线图关键值"><a href="#付费玩家在线时长箱线图关键值" class="headerlink" title="付费玩家在线时长箱线图关键值"></a>付费玩家在线时长箱线图关键值</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT min(avg_online_minutes) 最小值,</span><br><span class="line">(select avg_online_minutes from tap_fun_test where pay_price&gt;0 ORDER BY avg_online_minutes LIMIT 4886,1) as 下四分位数,</span><br><span class="line">(select avg_online_minutes from tap_fun_test where pay_price&gt;0 ORDER BY avg_online_minutes LIMIT 9774,1) as 中位数,</span><br><span class="line">(select avg_online_minutes from tap_fun_test where pay_price&gt;0 ORDER BY avg_online_minutes LIMIT 14661,1) as 上四分位数,</span><br><span class="line">max( avg_online_minutes) 最大值</span><br><span class="line">FROM `tap_fun_test` </span><br><span class="line">where pay_price&gt;0;</span><br></pre></td></tr></table></figure>
<h4 id="最小值：0-3333-下四分位数-30-6667-中位数-84-5，上四分位数：191-1667，最大值：1081-5"><a href="#最小值：0-3333-下四分位数-30-6667-中位数-84-5，上四分位数：191-1667，最大值：1081-5" class="headerlink" title="最小值：0.3333 ,下四分位数:30.6667,中位数:84.5，上四分位数：191.1667，最大值：1081.5"></a>最小值：0.3333 ,下四分位数:30.6667,中位数:84.5，上四分位数：191.1667，最大值：1081.5</h4><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.25066jtzv1vk.png"
                     
                ></p>
<p>全部玩家的在线时长箱线图中向下压缩的很厉害，全部玩家上四分位数为5，说明75%的玩家平均在线只有大约5分钟，可能一局游戏都没有玩完，可见玩家流失情况比较严重。<br>付费用户的箱型图中下四分位数为30，中位数84，上四分位数为191，说明付费用户中75%以上的用户在线时长都超过了30分钟。</p>
<h1 id="五、玩家付费情况分析"><a href="#五、玩家付费情况分析" class="headerlink" title="五、玩家付费情况分析"></a>五、玩家付费情况分析</h1><h3 id="关键指标"><a href="#关键指标" class="headerlink" title="关键指标"></a>关键指标</h3><p>AU（active users）活跃用户：游戏时长超过15分钟<br> PU（Paying users）付费用户<br>APA（Active Paying Account）:活跃付费用户数<br>ARPU：平均每个活跃用户的收入，总收入/AU<br> ARPPU：平均活跃付费用户收入,总收入/APU<br> PUR(付费比率)：APA/AU</p>
<h2 id="每个活跃玩家的收入"><a href="#每个活跃玩家的收入" class="headerlink" title="每个活跃玩家的收入"></a>每个活跃玩家的收入</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select count(DISTINCT user_id) as AU,</span><br><span class="line">(select sum(pay_price) from tap_fun_test as 总收入),</span><br><span class="line">(select sum(pay_price) from tap_fun_test) /count(DISTINCT user_id) as 每个活跃玩家收入 </span><br><span class="line">from tap_fun_test </span><br><span class="line">where avg_online_minutes &gt; 15;</span><br><span class="line">#and pay_price&gt;0;每个活跃付费玩家的收入</span><br></pre></td></tr></table></figure>
<h5 id="AU：99846，总收入：556900-04，每个活跃玩家收入ARPU：5-57758989"><a href="#AU：99846，总收入：556900-04，每个活跃玩家收入ARPU：5-57758989" class="headerlink" title="AU：99846，总收入：556900.04，每个活跃玩家收入ARPU：5.57758989"></a>AU：99846，总收入：556900.04，每个活跃玩家收入ARPU：5.57758989</h5><h2 id="每个活跃付费玩家的收入"><a href="#每个活跃付费玩家的收入" class="headerlink" title="每个活跃付费玩家的收入"></a>每个活跃付费玩家的收入</h2><h5 id="APA：16982，总收入：556900-04，每个活跃付费玩家收入ARPPU：32-79354846"><a href="#APA：16982，总收入：556900-04，每个活跃付费玩家收入ARPPU：32-79354846" class="headerlink" title="APA：16982，总收入：556900.04，每个活跃付费玩家收入ARPPU：32.79354846"></a>APA：16982，总收入：556900.04，每个活跃付费玩家收入ARPPU：32.79354846</h5><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.19kx2qgrrty8.png"
                     
                ></p>
<h1 id="付费比率"><a href="#付费比率" class="headerlink" title="付费比率"></a>付费比率</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select count(DISTINCT user_id) as APA ,</span><br><span class="line">(SELECT count(DISTINCT user_id) from tap_fun_test WHERE avg_online_minutes&gt;=15) as AU ,</span><br><span class="line">count(DISTINCT user_id)/(select count(DISTINCT user_id) from tap_fun_test </span><br><span class="line">where avg_online_minutes&gt;=15) as PUR</span><br><span class="line">from tap_fun_test </span><br><span class="line">where avg_online_minutes&gt;=15 and pay_price &gt;0;</span><br></pre></td></tr></table></figure>
<h5 id="APA：17005；AU：100649；活跃玩家的付费率PUR：0-169，全部玩家的付费比率：0-021"><a href="#APA：17005；AU：100649；活跃玩家的付费率PUR：0-169，全部玩家的付费比率：0-021" class="headerlink" title="APA：17005；AU：100649；活跃玩家的付费率PUR：0.169，全部玩家的付费比率：0.021"></a>APA：17005；AU：100649；活跃玩家的付费率PUR：0.169，全部玩家的付费比率：0.021</h5><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.7esl7b48tf28.png"
                     
                ></p>
<p>该游戏的PUR（人均付费率）为0.169较低，且ARPU（活跃玩家平均消费额）为5.58，说明收入表现差；相对于ARPPU，活跃付费用户消费很高，是ARPU的6倍左右，针对这点我们可以做首次消费门槛和专属大V玩家的福利与活动进行调整与优化。</p>
<h1 id="六、玩家游戏习惯分析"><a href="#六、玩家游戏习惯分析" class="headerlink" title="六、玩家游戏习惯分析"></a>六、玩家游戏习惯分析</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select AVG(pvp_battle_count) as 平均PVP次数 ,</span><br><span class="line">sum(pvp_lanch_count)/sum(pvp_battle_count) as 主动发起PVP概率,</span><br><span class="line">sum(pvp_win_count)/sum(pvp_battle_count) as PVP获胜概率</span><br><span class="line">from tap_fun_test</span><br><span class="line">where avg_online_minutes&gt;=15;</span><br><span class="line">PVP活跃玩家</span><br><span class="line">平均PVP次数：15.164651412333953；主动发起PVP概率：0.5688357584679884；PVP获胜概率：0.532222547626395</span><br><span class="line">PVP活跃付费玩家(加一个pay_price&gt;0)</span><br><span class="line">平均PVP次数：27.301911202587473；主动发起PVP概率：0.6553937480210826；PVP获胜概率：0.6872459716242092</span><br></pre></td></tr></table></figure>

<p>PVE活跃玩家<br>平均PVE次数：28；主动发起PVE概率：0.9967；PVE获胜概率：0.9041<br>PVE活跃付费玩家<br>平均PVE次数：52；主动发起PVE概率：0.9957；PVE获胜概率：0.9110</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.qcf66hymhfk.png"
                     
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.5z2txq9ht3wg.png"
                     
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/zhang18340082962/image-rick@master/image-rick/%E5%9B%BE%E7%89%87.6ycbt2l7v340.png"
                     
                ></p>
<p>APA（付费活跃用户）玩家的平均PVE和PVP次数都是AU（活跃）玩家次数的两倍左右，显然APA玩家是重要的发展对象。<br>PVP活动中，APA玩家主动发起和胜利的概率都明显高于AU玩家。<br>PVE活动中，APA玩家主动发起和胜利的概率与AU玩家都基本持平，其中主动发起PVE的概率非常高，且二者的PVE胜率高达90%，游戏体验较好。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">WenGe Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">WenGe Zhang</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
