<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="WenGe Zhang">
    
    <title>
        
            python办公自动化：操作excel |
        
        弦好想断
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.svg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.xml"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":false,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/avatar.svg","favicon":"/images/logo.svg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":"true# shadow effect when the mouse hover","scale":"true# scale effect when the mouse hover"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"毋庸置疑，好的事情总会到来，而当它来晚的时候，也不失为一种惊喜。"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"3.4.3"};
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                弦好想断
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                标签
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                关于
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">标签</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">关于</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">python办公自动化：操作excel</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.svg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">WenGe Zhang</span>
                        
                            <span class="author-label">干饭分析师</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;2021-12-08 22:28:43
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/">自动化</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>2.4k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>11 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <p>#python 使用 openpyxl 操作 excel</p>
<ul>
<li><p>openpyxl 最好用的 python 操作 excel 表格库，不接受反驳（想反驳自己去学其他的） </p>
</li>
<li><p>openpyxl 官网链接：<a class="link"   target="_blank" rel="noopener" href="https://openpyxl.readthedocs.io/en/stable/" >https://openpyxl.readthedocs.io/en/stable/<i class="fas fa-external-link-alt"></i></a></p>
</li>
<li><p><a class="link"   target="_blank" rel="noopener" href="https://www.zhihu.com/column/c_1261255815367487488" >https://www.zhihu.com/column/c_1261255815367487488<i class="fas fa-external-link-alt"></i></a></p>
</li>
<li><p>openpyxl 只支持【.xlsx / .xlsm / .xltx / .xltm】格式的文件</p>
</li>
<li><p>建议在jupyter-notebook里面操作</p>
<h3 id="打开-Excel-表格并获取表格名称；通过-sheet-名称获取表格"><a href="#打开-Excel-表格并获取表格名称；通过-sheet-名称获取表格" class="headerlink" title="打开 Excel 表格并获取表格名称；通过 sheet 名称获取表格"></a>打开 Excel 表格并获取表格名称；通过 sheet 名称获取表格</h3><pre class="line-numbers language-none"><code class="language-none">from openpyxl import load_workbook 
workbook &#x3D; load_workbook(filename &#x3D; &quot;test.xlsx&quot;) 
workbook.sheetnames #打开 Excel 表格并获取表格名称
sheet &#x3D; workbook[&quot;Sheet1&quot;] #通过 sheet 名称获取表格
sheet.dimensions # 获取表格的尺寸大小(几行几列数据)</code></pre>
<h3 id="获取表格内某个格子的数据"><a href="#获取表格内某个格子的数据" class="headerlink" title="获取表格内某个格子的数据"></a>获取表格内某个格子的数据</h3><pre class="line-numbers language-none"><code class="language-none">workbook &#x3D; load_workbook(filename &#x3D; &quot;test.xlsx&quot;) 
sheet &#x3D; workbook.active #打开激活的表格
print(sheet) 
cell1 &#x3D; sheet[&quot;A1&quot;] #获取 A1 格子的数据
cell2 &#x3D; sheet[&quot;C11&quot;] 
cell3 &#x3D; sheet.cell(row &#x3D; 1,column &#x3D; 1) #通过指定行列号获取格子数据
cell4 &#x3D; sheet.cell(row &#x3D; 11,column &#x3D; 3)
print(cell1.value, cell1.row, cell1.column, cell1.coordinate) 
#获取格子中的值、行数、列数、坐标；
sheet[&quot;A&quot;] --- 获取 A 列的数据
sheet[&quot;A:C&quot;] --- 获取 A,B,C 三列的数据
sheet[5] --- 只获取第 5 行的数据
# 获取 A1:C2 区域的值
cell &#x3D; sheet[&quot;A1:C2&quot;] 
print(cell) 
for i in cell: 
  for j in i: 
    print(j.value)</code></pre></li>
<li><p>.iter_rows()方式（类似pandas里面的iterrows）有.iter_rows()方式，肯定也会有.iter_cols()方式，只不过一个是按行读取，一个是按<br>列读取。</p>
<pre class="line-numbers language-none"><code class="language-none">workbook &#x3D; load_workbook(filename &#x3D; &quot;test.xlsx&quot;) 
sheet &#x3D; workbook.active 
print(sheet) 
# 按行获取值
for i in sheet.iter_rows(min_row&#x3D;2, max_row&#x3D;5, min_col&#x3D;1, max_col&#x3D;2): #按行读取
  for j in i: 
    print(j.value)
# 按列获取值
for i in sheet.iter_cols(min_row&#x3D;2, max_row&#x3D;5, min_col&#x3D;1, max_col&#x3D;2): #按列读取
  for j in i: 
    print(j.value)
for i in sheet.rows: #获取所有行
  print(i)</code></pre>
<h3 id="修改表格中的内容-向某个格子中写入内容并保存"><a href="#修改表格中的内容-向某个格子中写入内容并保存" class="headerlink" title="修改表格中的内容: 向某个格子中写入内容并保存"></a>修改表格中的内容: 向某个格子中写入内容并保存</h3><pre class="line-numbers language-none"><code class="language-none">workbook &#x3D; load_workbook(filename &#x3D; &quot;test.xlsx&quot;) 
sheet &#x3D; workbook.active 
print(sheet)
sheet[&quot;A1&quot;] &#x3D; &quot;哈喽&quot; 
# 这句代码也可以改为 cell &#x3D; sheet[&quot;A1&quot;] cell.value &#x3D; &quot;哈喽&quot; 
workbook.save(filename &#x3D; &quot;哈喽.xlsx&quot;) 
&quot;&quot;&quot; 
注意：我们将“A1”单元格的数据改为了“哈喽”，并另存为了“哈喽.xlsx”文
件。 如果我们保存的时候，不修改表名，相当于直接修改源文件；
&quot;&quot;&quot;</code></pre></li>
<li><p>.append()方式：会在表格已有的数据后面，按行插入数据(很有用)；</p>
<pre class="line-numbers language-none"><code class="language-none">workbook &#x3D; load_workbook(filename &#x3D; &quot;test.xlsx&quot;) 
sheet &#x3D; workbook.active
print(sheet) 
data &#x3D; [ 
[&quot;唐僧&quot;,&quot;男&quot;,&quot;180cm&quot;], 
[&quot;孙悟空&quot;,&quot;男&quot;,&quot;188cm&quot;], 
[&quot;猪八戒&quot;,&quot;男&quot;,&quot;175cm&quot;], 
[&quot;沙僧&quot;,&quot;男&quot;,&quot;176cm&quot;], 
] 
for row in data: 
  sheet.append(row) 
workbook.save(filename &#x3D; &quot;test.xlsx&quot;)</code></pre>
<h3 id="使用-excel-函数公式-很有用"><a href="#使用-excel-函数公式-很有用" class="headerlink" title="使用 excel 函数公式(很有用)"></a>使用 excel 函数公式(很有用)</h3><pre class="line-numbers language-none"><code class="language-none">import openpyxl
from openpyxl.utils import FORMULAE 
print(FORMULAE)#python 支持写哪些“excel 函数公式”</code></pre>
<pre class="line-numbers language-none"><code class="language-none"># 这是我们在 excel 中输入的公式
&#x3D;IF(RIGHT(C2,2)&#x3D;&quot;cm&quot;,C2,SUBSTITUTE(C2,&quot;m&quot;,&quot;&quot;)*100&amp;&quot;cm&quot;) 
# 那么，在 python 中怎么插入 excel 公式呢？
workbook &#x3D; load_workbook(filename &#x3D; &quot;test.xlsx&quot;) 
sheet &#x3D; workbook.active 
print(sheet) 
sheet[&quot;D1&quot;] &#x3D; &quot;标准身高&quot; 
for i in range(2,16): 
  sheet[&quot;D&#123;&#125;&quot;.format(i)] &#x3D; 
  &#39;&#x3D;IF(RIGHT(C&#123;&#125;,2)&#x3D;&quot;cm&quot;,C&#123;&#125;,SUBSTITUTE(C&#123;&#125;,&quot;m&quot;,&quot;&quot;)*100&amp;&quot;cm&quot;)&#39;.format(i,i,i) 
workbook.save(filename &#x3D; &quot;test.xlsx&quot;)</code></pre>
<h3 id="insert-cols-和-insert-rows-：插入空行和空列"><a href="#insert-cols-和-insert-rows-：插入空行和空列" class="headerlink" title=".insert_cols()和.insert_rows()：插入空行和空列"></a>.insert_cols()和.insert_rows()：插入空行和空列</h3></li>
<li><p>.insert_cols(idx=数字编号, amount=要插入的列数)，插入的位置是在 idx 列数的左侧插入；</p>
</li>
<li><p>.insert_rows(idx=数字编号, amount=要插入的行数)，插入的行数是在 idx 行数的下方插入；</p>
<pre class="line-numbers language-none"><code class="language-none">workbook &#x3D; load_workbook(filename &#x3D; &quot;test.xlsx&quot;) 
sheet &#x3D; workbook.active 
print(sheet) 
sheet.insert_cols(idx&#x3D;4,amount&#x3D;2) #从第4列开始插入2列
sheet.insert_rows(idx&#x3D;5,amount&#x3D;4) #第5行开始插入2行
workbook.save(filename &#x3D; &quot;test.xlsx&quot;)</code></pre></li>
</ul>
<h3 id="delete-rows-和-delete-cols-：删除行和列"><a href="#delete-rows-和-delete-cols-：删除行和列" class="headerlink" title=".delete_rows()和.delete_cols()：删除行和列"></a>.delete_rows()和.delete_cols()：删除行和列</h3><ul>
<li>.delete_rows(idx=数字编号, amount=要删除的行数)</li>
<li>.delete_cols(idx=数字编号, amount=要删除的列数)<pre class="line-numbers language-none"><code class="language-none">workbook &#x3D; load_workbook(filename &#x3D; &quot;test.xlsx&quot;) 
sheet &#x3D; workbook.active print(sheet) 
# 删除第一列，第一行
sheet.delete_cols(idx&#x3D;1) 
sheet.delete_rows(idx&#x3D;1) 
workbook.save(filename &#x3D; &quot;test.xlsx&quot;)</code></pre>
<h3 id="move-range-：移动格子"><a href="#move-range-：移动格子" class="headerlink" title=".move_range()：移动格子"></a>.move_range()：移动格子</h3></li>
<li>.move_range(“数据区域”,rows=,cols=)：row正整数表示向下、负整数表示向上移动；cols正整数表示向右、负整数表示向左移动。</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">sheet.move_range(&quot;C1:D4&quot;,rows&#x3D;2,cols&#x3D;-1)# 向左移动两列，向下移动两行</code></pre>
<h3 id="create-sheet-：创建新的-sheet-表格"><a href="#create-sheet-：创建新的-sheet-表格" class="headerlink" title=".create_sheet()：创建新的 sheet 表格"></a>.create_sheet()：创建新的 sheet 表格</h3><ul>
<li>.create_sheet(“新的 sheet 名”)：创建一个新的 sheet 表；<pre class="line-numbers language-none"><code class="language-none">workbook &#x3D; load_workbook(filename &#x3D; &quot;test.xlsx&quot;) 
sheet &#x3D; workbook.active 
print(sheet) 
workbook.create_sheet(&quot;我是一个新的 sheet&quot;) 
print(workbook.sheetnames) 
workbook.save(filename &#x3D; &quot;test.xlsx&quot;)</code></pre></li>
</ul>
<h3 id="remove-：删除某个-sheet-表"><a href="#remove-：删除某个-sheet-表" class="headerlink" title=".remove()：删除某个 sheet 表"></a>.remove()：删除某个 sheet 表</h3><ul>
<li>.remove(“sheet 名”)：删除某个 sheet 表；<pre class="line-numbers language-none"><code class="language-none">workbook &#x3D; load_workbook(filename &#x3D; &quot;test.xlsx&quot;) 
sheet &#x3D; workbook.active 
print(workbook.sheetnames) 
# 这个相当于激活的这个 sheet 表，激活状态下，才可以操作；
sheet &#x3D; workbook[&#39;我是一个新的 sheet&#39;] 
print(sheet) 
workbook.remove(sheet) 
print(workbook.sheetnames) 
workbook.save(filename &#x3D; &quot;test.xlsx&quot;)</code></pre></li>
</ul>
<h3 id="copy-worksheet-：复制一个-sheet-表到另外一张-excel-表"><a href="#copy-worksheet-：复制一个-sheet-表到另外一张-excel-表" class="headerlink" title=".copy_worksheet()：复制一个 sheet 表到另外一张 excel 表"></a>.copy_worksheet()：复制一个 sheet 表到另外一张 excel 表</h3><ul>
<li>这个操作的实质，就是复制某个 excel 表中的 sheet 表，然后将文件存储到另外一张excel 表中<pre class="line-numbers language-none"><code class="language-none">workbook &#x3D; load_workbook(filename &#x3D; &quot;a.xlsx&quot;) 
sheet &#x3D; workbook.active 
print(&quot;a.xlsx 中有这几个 sheet 表&quot;,workbook.sheetnames) 
sheet &#x3D; workbook[&#39;姓名&#39;] 
workbook.copy_worksheet(sheet) 
workbook.save(filename &#x3D; &quot;test.xlsx&quot;)</code></pre></li>
</ul>
<h3 id="sheet-title：修改-sheet-表的名称"><a href="#sheet-title：修改-sheet-表的名称" class="headerlink" title="sheet.title：修改 sheet 表的名称"></a>sheet.title：修改 sheet 表的名称</h3><pre class="line-numbers language-none"><code class="language-none">workbook &#x3D; load_workbook(filename &#x3D; &quot;a.xlsx&quot;) 
sheet &#x3D; workbook.active 
print(sheet) 
sheet.title &#x3D; &quot;我是修改后的 sheet 名&quot; 
print(sheet)</code></pre>

<h3 id="创建新的-excel-表格文件"><a href="#创建新的-excel-表格文件" class="headerlink" title="创建新的 excel 表格文件"></a>创建新的 excel 表格文件</h3><pre class="line-numbers language-none"><code class="language-none">from openpyxl import Workbook 
workbook &#x3D; Workbook() 
sheet &#x3D; workbook.active 
sheet.title &#x3D; &quot;表格 1&quot; 
workbook.save(filename &#x3D; &quot;新建的 excel 表格&quot;)</code></pre>

<h3 id="sheet-freeze-panes：冻结窗口"><a href="#sheet-freeze-panes：冻结窗口" class="headerlink" title="sheet.freeze_panes：冻结窗口"></a>sheet.freeze_panes：冻结窗口</h3><ul>
<li>.freeze_panes = “单元格”<pre class="line-numbers language-none"><code class="language-none">workbook &#x3D; load_workbook(filename &#x3D; &quot;花园.xlsx&quot;) 
sheet &#x3D; workbook.active 
print(sheet) 
sheet.freeze_panes &#x3D; &quot;C3&quot; 
workbook.save(filename &#x3D; &quot;花园.xlsx&quot;) 
&quot;&quot;&quot; 
冻结窗口以后，你可以打开源文件，进行检验；
&quot;&quot;&quot;</code></pre></li>
</ul>
<h3 id="sheet-auto-filter-ref：给表格添加“筛选器”"><a href="#sheet-auto-filter-ref：给表格添加“筛选器”" class="headerlink" title="sheet.auto_filter.ref：给表格添加“筛选器”"></a>sheet.auto_filter.ref：给表格添加“筛选器”</h3><ul>
<li>.auto_filter.ref = sheet.dimension 给所有字段添加筛选器；</li>
<li>.auto_filter.ref = “A1” 给 A1 这个格子添加“筛选器”，就是给第一列添加“筛选器”；<pre class="line-numbers language-none"><code class="language-none">workbook &#x3D; load_workbook(filename &#x3D; &quot;花园.xlsx&quot;) 
sheet &#x3D; workbook.active 
print(sheet) 
sheet.auto_filter.ref &#x3D; sheet[&quot;A1&quot;] 
workbook.save(filename &#x3D; &quot;花园.xlsx&quot;)</code></pre></li>
</ul>
<h2 id="批量调整字体和样式"><a href="#批量调整字体和样式" class="headerlink" title="批量调整字体和样式"></a>批量调整字体和样式</h2><h3 id="1、修改字体样式"><a href="#1、修改字体样式" class="headerlink" title="1、修改字体样式"></a>1、修改字体样式</h3><ul>
<li>Font(name=字体名称,size=字体大小,bold=是否加粗,italic=是否斜体,color=字体颜色)<pre class="line-numbers language-none"><code class="language-none">from openpyxl.styles import Font 
from openpyxl import load_workbook 
workbook &#x3D; load_workbook(filename&#x3D;&quot;花园.xlsx&quot;) 
sheet &#x3D; workbook.active 
cell &#x3D; sheet[&quot;A1&quot;] 
font &#x3D; Font(name&#x3D;&quot;微软雅黑&quot;,size&#x3D;20,bold&#x3D;True,italic&#x3D;True,color&#x3D;&quot;FF0000&quot;) 
cell.font &#x3D; font
workbook.save(filename &#x3D; &quot;花园.xlsx&quot;) 
&quot;&quot;&quot; 
这个 color 是 RGB 的 16 进制表示，自己下去百度学习；
&quot;&quot;&quot;</code></pre></li>
</ul>
<h3 id="2、获取表格中格子的字体样式"><a href="#2、获取表格中格子的字体样式" class="headerlink" title="2、获取表格中格子的字体样式"></a>2、获取表格中格子的字体样式</h3><pre class="line-numbers language-none"><code class="language-none">from openpyxl.styles import Font 
from openpyxl import load_workbook 
workbook &#x3D; load_workbook(filename&#x3D;&quot;花园.xlsx&quot;) 
sheet &#x3D; workbook.active 
cell &#x3D; sheet[&quot;A2&quot;] 
font &#x3D; cell.font 
print(font.name, font.size, font.bold, font.italic, font.color)</code></pre>

<h3 id="3、设置对齐样式"><a href="#3、设置对齐样式" class="headerlink" title="3、设置对齐样式"></a>3、设置对齐样式</h3><ul>
<li><p>Alignment(horizontal=水平对齐模式,vertical=垂直对齐模式,text_rotation=旋转角<br>度,wrap_text=是否自动换行)</p>
</li>
<li><p>水平对齐：‘distributed’，‘justify’，‘center’，‘leftfill’， ‘centerContinuous’，‘right，<br>‘general’；</p>
</li>
<li><p>垂直对齐：‘bottom’，‘distributed’，‘justify’，‘center’，‘top’；</p>
<pre class="line-numbers language-none"><code class="language-none">from openpyxl.styles import Alignment 
from openpyxl import load_workbook 
workbook &#x3D; load_workbook(filename&#x3D;&quot;花园.xlsx&quot;) 
sheet &#x3D; workbook.active 
cell &#x3D; sheet[&quot;A1&quot;]
alignment &#x3D; Alignment(horizontal&#x3D;&quot;center&quot;,vertical&#x3D;&quot;center&quot;,text_rotation&#x3D;45,wrap_text&#x3D;True) 
cell.alignment &#x3D; alignment 
workbook.save(filename &#x3D; &quot;花园.xlsx&quot;)</code></pre>
<h3 id="4、设置边框样式"><a href="#4、设置边框样式" class="headerlink" title="4、设置边框样式"></a>4、设置边框样式</h3></li>
<li><p>Side(style=边线样式，color=边线颜色)</p>
</li>
<li><p>Border(left=左边线样式，right=右边线样式，top=上边线样式，bottom=下边线样式)</p>
</li>
<li><p>style 参数的种类： ‘double, ‘mediumDashDotDot’, ‘slantDashDot’, ‘dashDotDot’,’dotted’,’hair’,<br>‘mediumDashed, ‘dashed’, ‘dashDot’, ‘thin’, ‘mediumDashDot’,’medium’, ‘thick’</p>
<pre class="line-numbers language-none"><code class="language-none">from openpyxl.styles import Side,Border 
from openpyxl import load_workbook 
workbook &#x3D; load_workbook(filename&#x3D;&quot;花园.xlsx&quot;) 
sheet &#x3D; workbook.active 
cell &#x3D; sheet[&quot;D6&quot;]
side1 &#x3D; Side(style&#x3D;&quot;thin&quot;,color&#x3D;&quot;FF0000&quot;) 
side2 &#x3D; Side(style&#x3D;&quot;thick&quot;,color&#x3D;&quot;FFFF0000&quot;) 
border &#x3D; Border(left&#x3D;side1,right&#x3D;side1,top&#x3D;side2,bottom&#x3D;side2) 
cell.border &#x3D; border 
workbook.save(filename &#x3D; &quot;花园.xlsx&quot;)</code></pre></li>
</ul>
<h3 id="5、设置填充样式"><a href="#5、设置填充样式" class="headerlink" title="5、设置填充样式"></a>5、设置填充样式</h3><ul>
<li><p>PatternFill(fill_type=填充样式，fgColor=填充颜色）</p>
</li>
<li><p>GradientFill(stop=(渐变颜色 1，渐变颜色 2……))</p>
<pre class="line-numbers language-none"><code class="language-none">from openpyxl.styles import PatternFill,GradientFill 
from openpyxl import load_workbook 
workbook &#x3D; load_workbook(filename&#x3D;&quot;花园.xlsx&quot;) 
sheet &#x3D; workbook.active 
cell_b9 &#x3D; sheet[&quot;B9&quot;] 
pattern_fill &#x3D; PatternFill(fill_type&#x3D;&quot;solid&quot;,fgColor&#x3D;&quot;99ccff&quot;) 
cell_b9.fill &#x3D; pattern_fill 
cell_b10 &#x3D; sheet[&quot;B10&quot;]
gradient_fill &#x3D; GradientFill(stop&#x3D;(&quot;FFFFFF&quot;,&quot;99ccff&quot;,&quot;000000&quot;)) 
cell_b10.fill &#x3D; gradient_fill 
workbook.save(filename &#x3D; &quot;花园.xlsx&quot;)</code></pre>
<h3 id="6、设置行高和列宽"><a href="#6、设置行高和列宽" class="headerlink" title="6、设置行高和列宽"></a>6、设置行高和列宽</h3></li>
<li><p>.row_dimensions[行编号].height = 行高</p>
</li>
<li><p>.column_dimensions[列编号].width = 列宽</p>
<pre class="line-numbers language-none"><code class="language-none">workbook &#x3D; load_workbook(filename&#x3D;&quot;花园.xlsx&quot;) 
sheet &#x3D; workbook.active 
# 设置第 1 行的高度
sheet.row_dimensions[1].height &#x3D; 50 #将整个表的行高设置为 50
# 设置 B 列的宽度
sheet.column_dimensions[&quot;B&quot;].width &#x3D; 20 #列宽设置为 30；
workbook.save(filename &#x3D; &quot;花园.xlsx&quot;)</code></pre></li>
</ul>
<h3 id="7、合并单元格"><a href="#7、合并单元格" class="headerlink" title="7、合并单元格"></a>7、合并单元格</h3><ul>
<li>.merge_cells(待合并的格子编号)</li>
<li>.merge_cells(start_row=起始行号，start_column=起始列号，end_row=结束行号，<br>end_column=结束列号)<pre class="line-numbers language-none"><code class="language-none">workbook &#x3D; load_workbook(filename&#x3D;&quot;花园.xlsx&quot;)
sheet &#x3D; workbook.active sheet.merge_cells(&quot;C1:D2&quot;) 
sheet.merge_cells(start_row&#x3D;7,start_column&#x3D;1,end_row&#x3D;8,end_column&#x3D;3) 
workbook.save(filename &#x3D; &quot;花园.xlsx&quot;)</code></pre>
当然，也有“取消合并单元格”，用法一致。</li>
<li>.unmerge_cells(待合并的格子编号)</li>
<li>.unmerge_cells(start_row=起始行号，start_column=起始列号，end_row=结束行号，<br>end_column=结束列号)</li>
</ul>

        </div>

        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/post/mysql-tips.html"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">mysql_tips</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/post/requests%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3.html"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">python中requests使用中文乱码的解决方案</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">WenGe Zhang</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.3</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%93%E5%BC%80-Excel-%E8%A1%A8%E6%A0%BC%E5%B9%B6%E8%8E%B7%E5%8F%96%E8%A1%A8%E6%A0%BC%E5%90%8D%E7%A7%B0%EF%BC%9B%E9%80%9A%E8%BF%87-sheet-%E5%90%8D%E7%A7%B0%E8%8E%B7%E5%8F%96%E8%A1%A8%E6%A0%BC"><span class="nav-number">1.</span> <span class="nav-text">打开 Excel 表格并获取表格名称；通过 sheet 名称获取表格</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E8%A1%A8%E6%A0%BC%E5%86%85%E6%9F%90%E4%B8%AA%E6%A0%BC%E5%AD%90%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="nav-number">2.</span> <span class="nav-text">获取表格内某个格子的数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8%E6%A0%BC%E4%B8%AD%E7%9A%84%E5%86%85%E5%AE%B9-%E5%90%91%E6%9F%90%E4%B8%AA%E6%A0%BC%E5%AD%90%E4%B8%AD%E5%86%99%E5%85%A5%E5%86%85%E5%AE%B9%E5%B9%B6%E4%BF%9D%E5%AD%98"><span class="nav-number">3.</span> <span class="nav-text">修改表格中的内容: 向某个格子中写入内容并保存</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-excel-%E5%87%BD%E6%95%B0%E5%85%AC%E5%BC%8F-%E5%BE%88%E6%9C%89%E7%94%A8"><span class="nav-number">4.</span> <span class="nav-text">使用 excel 函数公式(很有用)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#insert-cols-%E5%92%8C-insert-rows-%EF%BC%9A%E6%8F%92%E5%85%A5%E7%A9%BA%E8%A1%8C%E5%92%8C%E7%A9%BA%E5%88%97"><span class="nav-number">5.</span> <span class="nav-text">.insert_cols()和.insert_rows()：插入空行和空列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#delete-rows-%E5%92%8C-delete-cols-%EF%BC%9A%E5%88%A0%E9%99%A4%E8%A1%8C%E5%92%8C%E5%88%97"><span class="nav-number">6.</span> <span class="nav-text">.delete_rows()和.delete_cols()：删除行和列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#move-range-%EF%BC%9A%E7%A7%BB%E5%8A%A8%E6%A0%BC%E5%AD%90"><span class="nav-number">7.</span> <span class="nav-text">.move_range()：移动格子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#create-sheet-%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84-sheet-%E8%A1%A8%E6%A0%BC"><span class="nav-number">8.</span> <span class="nav-text">.create_sheet()：创建新的 sheet 表格</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#remove-%EF%BC%9A%E5%88%A0%E9%99%A4%E6%9F%90%E4%B8%AA-sheet-%E8%A1%A8"><span class="nav-number">9.</span> <span class="nav-text">.remove()：删除某个 sheet 表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#copy-worksheet-%EF%BC%9A%E5%A4%8D%E5%88%B6%E4%B8%80%E4%B8%AA-sheet-%E8%A1%A8%E5%88%B0%E5%8F%A6%E5%A4%96%E4%B8%80%E5%BC%A0-excel-%E8%A1%A8"><span class="nav-number">10.</span> <span class="nav-text">.copy_worksheet()：复制一个 sheet 表到另外一张 excel 表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sheet-title%EF%BC%9A%E4%BF%AE%E6%94%B9-sheet-%E8%A1%A8%E7%9A%84%E5%90%8D%E7%A7%B0"><span class="nav-number">11.</span> <span class="nav-text">sheet.title：修改 sheet 表的名称</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84-excel-%E8%A1%A8%E6%A0%BC%E6%96%87%E4%BB%B6"><span class="nav-number">12.</span> <span class="nav-text">创建新的 excel 表格文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sheet-freeze-panes%EF%BC%9A%E5%86%BB%E7%BB%93%E7%AA%97%E5%8F%A3"><span class="nav-number">13.</span> <span class="nav-text">sheet.freeze_panes：冻结窗口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sheet-auto-filter-ref%EF%BC%9A%E7%BB%99%E8%A1%A8%E6%A0%BC%E6%B7%BB%E5%8A%A0%E2%80%9C%E7%AD%9B%E9%80%89%E5%99%A8%E2%80%9D"><span class="nav-number">14.</span> <span class="nav-text">sheet.auto_filter.ref：给表格添加“筛选器”</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%B9%E9%87%8F%E8%B0%83%E6%95%B4%E5%AD%97%E4%BD%93%E5%92%8C%E6%A0%B7%E5%BC%8F"><span class="nav-number"></span> <span class="nav-text">批量调整字体和样式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%E3%80%81%E4%BF%AE%E6%94%B9%E5%AD%97%E4%BD%93%E6%A0%B7%E5%BC%8F"><span class="nav-number">1.</span> <span class="nav-text">1、修改字体样式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%E3%80%81%E8%8E%B7%E5%8F%96%E8%A1%A8%E6%A0%BC%E4%B8%AD%E6%A0%BC%E5%AD%90%E7%9A%84%E5%AD%97%E4%BD%93%E6%A0%B7%E5%BC%8F"><span class="nav-number">2.</span> <span class="nav-text">2、获取表格中格子的字体样式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3%E3%80%81%E8%AE%BE%E7%BD%AE%E5%AF%B9%E9%BD%90%E6%A0%B7%E5%BC%8F"><span class="nav-number">3.</span> <span class="nav-text">3、设置对齐样式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4%E3%80%81%E8%AE%BE%E7%BD%AE%E8%BE%B9%E6%A1%86%E6%A0%B7%E5%BC%8F"><span class="nav-number">4.</span> <span class="nav-text">4、设置边框样式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5%E3%80%81%E8%AE%BE%E7%BD%AE%E5%A1%AB%E5%85%85%E6%A0%B7%E5%BC%8F"><span class="nav-number">5.</span> <span class="nav-text">5、设置填充样式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6%E3%80%81%E8%AE%BE%E7%BD%AE%E8%A1%8C%E9%AB%98%E5%92%8C%E5%88%97%E5%AE%BD"><span class="nav-number">6.</span> <span class="nav-text">6、设置行高和列宽</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7%E3%80%81%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC"><span class="nav-number">7.</span> <span class="nav-text">7、合并单元格</span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/code-copy.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
